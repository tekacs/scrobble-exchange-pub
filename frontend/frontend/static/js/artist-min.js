/*!jQuery Knob*//**
 * Downward compatible, touchable dial
 *
 * Version: 1.2.0 (15/07/2012)
 * Requires: jQuery v1.7+
 *
 * Copyright (c) 2012 Anthony Terrien
 * Under MIT and GPL licenses:
 *  http://www.opensource.org/licenses/mit-license.php
 *  http://www.gnu.org/licenses/gpl.html
 *
 * Thanks to vor, eskimoblood, spiffistan, FabrizioC
 */(function(e){"use strict";var t={},n=Math.max,r=Math.min;t.c={};t.c.d=e(document);t.c.t=function(e){return e.originalEvent.touches.length-1};t.o=function(){var n=this;this.o=null;this.$=null;this.i=null;this.g=null;this.v=null;this.cv=null;this.x=0;this.y=0;this.$c=null;this.c=null;this.t=0;this.isInit=!1;this.fgColor=null;this.pColor=null;this.dH=null;this.cH=null;this.eH=null;this.rH=null;this.run=function(){var t=function(e,t){var r;for(r in t)n.o[r]=t[r];n.init();n._configure()._draw()};if(this.$.data("kontroled"))return;this.$.data("kontroled",!0);this.extend();this.o=e.extend({min:this.$.data("min")||0,max:this.$.data("max")||100,stopper:!0,readOnly:this.$.data("readonly"),cursor:this.$.data("cursor")===!0&&30||this.$.data("cursor")||0,thickness:this.$.data("thickness")||.35,lineCap:this.$.data("linecap")||"butt",width:this.$.data("width")||200,height:this.$.data("height")||200,displayInput:this.$.data("displayinput")==null||this.$.data("displayinput"),displayPrevious:this.$.data("displayprevious"),fgColor:this.$.data("fgcolor")||"#87CEEB",inputColor:this.$.data("inputcolor")||this.$.data("fgcolor")||"#87CEEB",inline:!1,draw:null,change:null,cancel:null,release:null},this.o);if(this.$.is("fieldset")){this.v={};this.i=this.$.find("input");this.i.each(function(t){var r=e(this);n.i[t]=r;n.v[t]=r.val();r.bind("change",function(){var e={};e[t]=r.val();n.val(e)})});this.$.find("legend").remove()}else{this.i=this.$;this.v=this.$.val();this.v==""&&(this.v=this.o.min);this.$.bind("change",function(){n.val(n.$.val())})}!this.o.displayInput&&this.$.hide();this.$c=e('<canvas width="'+this.o.width+'px" height="'+this.o.height+'px"></canvas>');this.c=this.$c[0].getContext("2d");this.$.wrap(e('<div style="'+(this.o.inline?"display:inline;":"")+"width:"+this.o.width+"px;height:"+this.o.height+'px;"></div>')).before(this.$c);if(this.v instanceof Object){this.cv={};this.copy(this.v,this.cv)}else this.cv=this.v;this.$.bind("configure",t).parent().bind("configure",t);this._listen()._configure()._xy().init();this.isInit=!0;this._draw();return this};this._draw=function(){var e=!0,t=document.createElement("canvas");t.width=n.o.width;t.height=n.o.height;n.g=t.getContext("2d");n.clear();n.dH&&(e=n.dH());e!==!1&&n.draw();n.c.drawImage(t,0,0);t=null};this._touch=function(e){var r=function(e){var t=n.xy2val(e.originalEvent.touches[n.t].pageX,e.originalEvent.touches[n.t].pageY);if(t==n.cv)return;if(n.cH&&n.cH(t)===!1)return;n.change(t);n._draw()};this.t=t.c.t(e);r(e);t.c.d.bind("touchmove.k",r).bind("touchend.k",function(){t.c.d.unbind("touchmove.k touchend.k");if(n.rH&&n.rH(n.cv)===!1)return;n.val(n.cv)});return this};this._mouse=function(e){var r=function(e){var t=n.xy2val(e.pageX,e.pageY);if(t==n.cv)return;if(n.cH&&n.cH(t)===!1)return;n.change(t);n._draw()};r(e);t.c.d.bind("mousemove.k",r).bind("keyup.k",function(e){if(e.keyCode===27){t.c.d.unbind("mouseup.k mousemove.k keyup.k");if(n.eH&&n.eH()===!1)return;n.cancel()}}).bind("mouseup.k",function(e){t.c.d.unbind("mousemove.k mouseup.k keyup.k");if(n.rH&&n.rH(n.cv)===!1)return;n.val(n.cv)});return this};this._xy=function(){var e=this.$c.offset();this.x=e.left;this.y=e.top;return this};this._listen=function(){if(!this.o.readOnly){this.$c.bind("mousedown",function(e){e.preventDefault();n._xy()._mouse(e)}).bind("touchstart",function(e){e.preventDefault();n._xy()._touch(e)});this.listen()}else this.$.attr("readonly","readonly");return this};this._configure=function(){this.o.draw&&(this.dH=this.o.draw);this.o.change&&(this.cH=this.o.change);this.o.cancel&&(this.eH=this.o.cancel);this.o.release&&(this.rH=this.o.release);if(this.o.displayPrevious){this.pColor=this.h2rgba(this.o.fgColor,"0.4");this.fgColor=this.h2rgba(this.o.fgColor,"0.6")}else this.fgColor=this.o.fgColor;return this};this._clear=function(){this.$c[0].width=this.$c[0].width};this.listen=function(){};this.extend=function(){};this.init=function(){};this.change=function(e){};this.val=function(e){};this.xy2val=function(e,t){};this.draw=function(){};this.clear=function(){this._clear()};this.h2rgba=function(e,t){var n;e=e.substring(1,7);n=[parseInt(e.substring(0,2),16),parseInt(e.substring(2,4),16),parseInt(e.substring(4,6),16)];return"rgba("+n[0]+","+n[1]+","+n[2]+","+t+")"};this.copy=function(e,t){for(var n in e)t[n]=e[n]}};t.Dial=function(){t.o.call(this);this.startAngle=null;this.xy=null;this.radius=null;this.lineWidth=null;this.cursorExt=null;this.w2=null;this.PI2=2*Math.PI;this.extend=function(){this.o=e.extend({bgColor:this.$.data("bgcolor")||"#EEEEEE",angleOffset:this.$.data("angleoffset")||0,angleArc:this.$.data("anglearc")||360,inline:!0},this.o)};this.val=function(e){if(null==e)return this.v;this.cv=this.o.stopper?n(r(e,this.o.max),this.o.min):e;this.v=this.cv;this.$.val(this.v);this._draw()};this.xy2val=function(e,t){var i,s;i=Math.atan2(e-(this.x+this.w2),-(t-this.y-this.w2))-this.angleOffset;this.angleArc!=this.PI2&&i<0&&i>-0.5?i=0:i<0&&(i+=this.PI2);s=~~(.5+i*(this.o.max-this.o.min)/this.angleArc)+this.o.min;this.o.stopper&&(s=n(r(s,this.o.max),this.o.min));return s};this.listen=function(){var t=this,i=function(e){e.preventDefault();var n=e.originalEvent,r=n.detail||n.wheelDeltaX,i=n.detail||n.wheelDeltaY,s=parseInt(t.$.val())+(r>0||i>0?1:r<0||i<0?-1:0);if(t.cH&&t.cH(s)===!1)return;t.val(s)},s,o,u=1,a={37:-1,38:1,39:1,40:-1};this.$.bind("keydown",function(i){var f=i.keyCode;f>=96&&f<=105&&(f=i.keyCode=f-48);s=parseInt(String.fromCharCode(f));if(isNaN(s)){f!==13&&f!==8&&f!==9&&f!==189&&i.preventDefault();if(e.inArray(f,[37,38,39,40])>-1){i.preventDefault();var l=parseInt(t.$.val())+a[f]*u;t.o.stopper&&(l=n(r(l,t.o.max),t.o.min));t.change(l);t._draw();o=window.setTimeout(function(){u*=2},30)}}}).bind("keyup",function(e){if(isNaN(s)){if(o){window.clearTimeout(o);o=null;u=1;t.val(t.$.val())}}else t.$.val()>t.o.max&&t.$.val(t.o.max)||t.$.val()<t.o.min&&t.$.val(t.o.min)});this.$c.bind("mousewheel DOMMouseScroll",i);this.$.bind("mousewheel DOMMouseScroll",i)};this.init=function(){if(this.v<this.o.min||this.v>this.o.max)this.v=this.o.min;this.$.val(this.v);this.w2=this.o.width/2;this.cursorExt=this.o.cursor/100;this.xy=this.w2;this.lineWidth=this.xy*this.o.thickness;this.lineCap=this.o.lineCap;this.radius=this.xy-this.lineWidth/2;this.o.angleOffset&&(this.o.angleOffset=isNaN(this.o.angleOffset)?0:this.o.angleOffset);this.o.angleArc&&(this.o.angleArc=isNaN(this.o.angleArc)?this.PI2:this.o.angleArc);this.angleOffset=this.o.angleOffset*Math.PI/180;this.angleArc=this.o.angleArc*Math.PI/180;this.startAngle=1.5*Math.PI+this.angleOffset;this.endAngle=1.5*Math.PI+this.angleOffset+this.angleArc;var e=n(String(Math.abs(this.o.max)).length,String(Math.abs(this.o.min)).length,2)+2;this.o.displayInput&&this.i.css({width:(this.o.width/2+4>>0)+"px",height:(this.o.width/3>>0)+"px",position:"absolute","vertical-align":"middle","margin-top":(this.o.width/3>>0)+"px","margin-left":"-"+(this.o.width*3/4+2>>0)+"px",border:0,background:"none",font:"bold "+(this.o.width/e>>0)+"px Arial","text-align":"center",color:this.o.inputColor||this.o.fgColor,padding:"0px","-webkit-appearance":"none"})||this.i.css({width:"0px",visibility:"hidden"})};this.change=function(e){this.cv=e;this.$.val(e)};this.angle=function(e){return(e-this.o.min)*this.angleArc/(this.o.max-this.o.min)};this.draw=function(){var e=this.g,t=this.angle(this.cv),n=this.startAngle,r=n+t,i,s,o=1;e.lineWidth=this.lineWidth;e.lineCap=this.lineCap;this.o.cursor&&(n=r-this.cursorExt)&&(r+=this.cursorExt);e.beginPath();e.strokeStyle=this.o.bgColor;e.arc(this.xy,this.xy,this.radius,this.endAngle,this.startAngle,!0);e.stroke();if(this.o.displayPrevious){s=this.startAngle+this.angle(this.v);i=this.startAngle;this.o.cursor&&(i=s-this.cursorExt)&&(s+=this.cursorExt);e.beginPath();e.strokeStyle=this.pColor;e.arc(this.xy,this.xy,this.radius,i,s,!1);e.stroke();o=this.cv==this.v}e.beginPath();e.strokeStyle=o?this.o.fgColor:this.fgColor;e.arc(this.xy,this.xy,this.radius,n,r,!1);e.stroke()};this.cancel=function(){this.val(this.v)}};e.fn.dial=e.fn.knob=function(n){return this.each(function(){var r=new t.Dial;r.o=n;r.$=e(this);r.run()}).parent()}})(jQuery);(function(){function e(e){var t=-1,n=e.length,r=[];while(++t<n)r.push(e[t]);return r}function t(e){return Array.prototype.slice.call(e)}function n(){return this}function r(e){return e!=null&&!isNaN(e)}function i(e){return e.length}function s(e){return e==null}function o(e){return e.replace(/(^\s+)|(\s+$)/g,"").replace(/\s+/g," ")}function u(){}function a(){function e(){var e=t,n=-1,r=e.length,i;while(++n<r)(i=e[n])._on&&i.apply(this,arguments)}var t=[],n={};return e.on=function(r,i){var s,o;if(s=n[r])s._on=!1,t=t.slice(0,o=t.indexOf(s)).concat(t.slice(o+1)),delete n[r];return i&&(i._on=!0,t.push(i),n[r]=i),e},e}function f(e,t){return t-(e?1+Math.floor(Math.log(e+Math.pow(10,1+Math.floor(Math.log(e)/Math.LN10)-t))/Math.LN10):1)}function l(e){return e+""}function c(e){var t=e.lastIndexOf("."),n=t>=0?e.substring(t):(t=e.length,""),r=[];while(t>0)r.push(e.substring(t-=3,t+3));return r.reverse().join(",")+n}function h(e,t){return{scale:Math.pow(10,(8-t)*3),symbol:e}}function p(e){return function(t){return t<=0?0:t>=1?1:e(t)}}function d(e){return function(t){return 1-e(1-t)}}function v(e){return function(t){return.5*(t<.5?e(2*t):2-e(2-2*t))}}function m(e){return e}function g(e){return function(t){return Math.pow(t,e)}}function y(e){return 1-Math.cos(e*Math.PI/2)}function b(e){return Math.pow(2,10*(e-1))}function w(e){return 1-Math.sqrt(1-e*e)}function E(e,t){var n;return arguments.length<2&&(t=.45),arguments.length<1?(e=1,n=t/4):n=t/(2*Math.PI)*Math.asin(1/e),function(r){return 1+e*Math.pow(2,10*-r)*Math.sin((r-n)*2*Math.PI/t)}}function S(e){return e||(e=1.70158),function(t){return t*t*((e+1)*t-e)}}function x(e){return e<1/2.75?7.5625*e*e:e<2/2.75?7.5625*(e-=1.5/2.75)*e+.75:e<2.5/2.75?7.5625*(e-=2.25/2.75)*e+.9375:7.5625*(e-=2.625/2.75)*e+.984375}function T(){d3.event.stopPropagation(),d3.event.preventDefault()}function N(e){return e=="transform"?d3.interpolateTransform:d3.interpolate}function C(e,t){return t=t-(e=+e)?1/(t-e):0,function(n){return(n-e)*t}}function k(e,t){return t=t-(e=+e)?1/(t-e):0,function(n){return Math.max(0,Math.min(1,(n-e)*t))}}function L(e,t,n){return new A(e,t,n)}function A(e,t,n){this.r=e,this.g=t,this.b=n}function O(e){return e<16?"0"+Math.max(0,e).toString(16):Math.min(255,e).toString(16)}function M(e,t,n){var r=0,i=0,s=0,o,u,a;o=/([a-z]+)\((.*)\)/i.exec(e);if(o){u=o[2].split(",");switch(o[1]){case"hsl":return n(parseFloat(u[0]),parseFloat(u[1])/100,parseFloat(u[2])/100);case"rgb":return t(D(u[0]),D(u[1]),D(u[2]))}}return(a=Vn[e])?t(a.r,a.g,a.b):(e!=null&&e.charAt(0)==="#"&&(e.length===4?(r=e.charAt(1),r+=r,i=e.charAt(2),i+=i,s=e.charAt(3),s+=s):e.length===7&&(r=e.substring(1,3),i=e.substring(3,5),s=e.substring(5,7)),r=parseInt(r,16),i=parseInt(i,16),s=parseInt(s,16)),t(r,i,s))}function _(e,t,n){var r=Math.min(e/=255,t/=255,n/=255),i=Math.max(e,t,n),s=i-r,o,u,a=(i+r)/2;return s?(u=a<.5?s/(i+r):s/(2-i-r),e==i?o=(t-n)/s+(t<n?6:0):t==i?o=(n-e)/s+2:o=(e-t)/s+4,o*=60):u=o=0,P(o,u,a)}function D(e){var t=parseFloat(e);return e.charAt(e.length-1)==="%"?Math.round(t*2.55):t}function P(e,t,n){return new H(e,t,n)}function H(e,t,n){this.h=e,this.s=t,this.l=n}function B(e,t,n){function r(e){return e>360?e-=360:e<0&&(e+=360),e<60?s+(o-s)*e/60:e<180?o:e<240?s+(o-s)*(240-e)/60:s}function i(e){return Math.round(r(e)*255)}var s,o;return e%=360,e<0&&(e+=360),t=t<0?0:t>1?1:t,n=n<0?0:n>1?1:n,o=n<=.5?n*(1+t):n+t-n*t,s=2*n-o,L(i(e+120),i(e),i(e-120))}function j(e){return Bn(e,Qn),e}function F(e){return function(){return Jn(e,this)}}function I(e){return function(){return Kn(e,this)}}function q(e,t){function n(){if(t=this.classList)return t.add(e);var t=this.className,n=t.baseVal!=null,r=n?t.baseVal:t;s.lastIndex=0,s.test(r)||(r=o(r+" "+e),n?t.baseVal=r:this.className=r)}function r(){if(t=this.classList)return t.remove(e);var t=this.className,n=t.baseVal!=null,r=n?t.baseVal:t;r=o(r.replace(s," ")),n?t.baseVal=r:this.className=r}function i(){(t.apply(this,arguments)?n:r).call(this)}var s=new RegExp("(^|\\s+)"+d3.requote(e)+"(\\s+|$)","g");if(arguments.length<2){var u=this.node();if(a=u.classList)return a.contains(e);var a=u.className;return s.lastIndex=0,s.test(a.baseVal!=null?a.baseVal:a)}return this.each(typeof t=="function"?i:t?n:r)}function R(e){return{__data__:e}}function U(e){return arguments.length||(e=d3.ascending),function(t,n){return e(t&&t.__data__,n&&n.__data__)}}function z(e){return Bn(e,Zn),e}function W(e,t,n){Bn(e,tr);var r={},i=d3.dispatch("start","end"),s=ir;return e.id=t,e.time=n,e.tween=function(t,n){return arguments.length<2?r[t]:(n==null?delete r[t]:r[t]=n,e)},e.ease=function(t){return arguments.length?(s=typeof t=="function"?t:d3.ease.apply(d3,arguments),e):s},e.each=function(t,n){return arguments.length<2?$.call(e,t):(i.on(t,n),e)},d3.timer(function(o){return e.each(function(u,a,f){function l(e){if(g.active>t)return h();g.active=t;for(var s in r)(s=r[s].call(d,u,a))&&p.push(s);return i.start.call(d,u,a),c(e)||d3.timer(c,0,n),1}function c(e){if(g.active!==t)return h();var n=(e-v)/m,r=s(n),o=p.length;while(o>0)p[--o].call(d,r);if(n>=1)return h(),rr=t,i.end.call(d,u,a),rr=0,1}function h(){return--g.count||delete d.__transition__,1}var p=[],d=this,v=e[f][a].delay,m=e[f][a].duration,g=d.__transition__||(d.__transition__={active:0,count:0});++g.count,v<=o?l(o):d3.timer(l,v,n)}),1},0,n),e}function X(e,t,n){return n!=""&&er}function V(e,t){function n(e,n,r){var s=t.call(this,e,n);return s==null?r!=""&&er:r!=s&&i(r,s)}function r(e,n,r){return r!=t&&i(r,t)}var i=N(e);return typeof t=="function"?n:t==null?X:(t+="",r)}function $(e){for(var t=0,n=this.length;t<n;t++)for(var r=this[t],i=0,s=r.length;i<s;i++){var o=r[i];o&&e.call(o=o.node,o.__data__,i,t)}return this}function J(){var e,t=Date.now(),n=sr;while(n)e=t-n.then,e>=n.delay&&(n.flush=n.callback(e)),n=n.next;var r=K()-t;r>24?(isFinite(r)&&(clearTimeout(ur),ur=setTimeout(J,r)),or=0):(or=1,ar(J))}function K(){var e=null,t=sr,n=Infinity;while(t)t.flush?t=e?e.next=t.next:sr=t.next:(n=Math.min(n,t.then+t.delay),t=(e=t).next);return n}function Q(e){var t=[e.a,e.b],n=[e.c,e.d],r=Y(t),i=G(t,n),s=Y(Z(n,t,-i));this.translate=[e.e,e.f],this.rotate=Math.atan2(e.b,e.a)*lr,this.scale=[r,s||0],this.skew=s?i/s*lr:0}function G(e,t){return e[0]*t[0]+e[1]*t[1]}function Y(e){var t=Math.sqrt(G(e,e));return e[0]/=t,e[1]/=t,t}function Z(e,t,n){return e[0]+=n*t[0],e[1]+=n*t[1],e}function et(){}function tt(e){var t=e[0],n=e[e.length-1];return t<n?[t,n]:[n,t]}function nt(e,t){var n=0,r=e.length-1,i=e[n],s=e[r],o;s<i&&(o=n,n=r,r=o,o=i,i=s,s=o);if(o=s-i)t=t(o),e[n]=t.floor(i),e[r]=t.ceil(s);return e}function rt(){return Math}function it(e,t,n,r){function i(){var i=e.length==2?lt:ct,a=r?k:C;return o=i(e,t,a,n),u=i(t,e,a,d3.interpolate),s}function s(e){return o(e)}var o,u;return s.invert=function(e){return u(e)},s.domain=function(t){return arguments.length?(e=t.map(Number),i()):e},s.range=function(e){return arguments.length?(t=e,i()):t},s.rangeRound=function(e){return s.range(e).interpolate(d3.interpolateRound)},s.clamp=function(e){return arguments.length?(r=e,i()):r},s.interpolate=function(e){return arguments.length?(n=e,i()):n},s.ticks=function(t){return at(e,t)},s.tickFormat=function(t){return ft(e,t)},s.nice=function(){return nt(e,ot),i()},s.copy=function(){return it(e,t,n,r)},i()}function st(e,t){return e.range=d3.rebind(e,t.range),e.rangeRound=d3.rebind(e,t.rangeRound),e.interpolate=d3.rebind(e,t.interpolate),e.clamp=d3.rebind(e,t.clamp),e}function ot(e){return e=Math.pow(10,Math.round(Math.log(e)/Math.LN10)-1),{floor:function(t){return Math.floor(t/e)*e},ceil:function(t){return Math.ceil(t/e)*e}}}function ut(e,t){var n=tt(e),r=n[1]-n[0],i=Math.pow(10,Math.floor(Math.log(r/t)/Math.LN10)),s=t/r*i;return s<=.15?i*=10:s<=.35?i*=5:s<=.75&&(i*=2),n[0]=Math.ceil(n[0]/i)*i,n[1]=Math.floor(n[1]/i)*i+i*.5,n[2]=i,n}function at(e,t){return d3.range.apply(d3,ut(e,t))}function ft(e,t){return d3.format(",."+Math.max(0,-Math.floor(Math.log(ut(e,t)[2])/Math.LN10+.01))+"f")}function lt(e,t,n,r){var i=n(e[0],e[1]),s=r(t[0],t[1]);return function(e){return s(i(e))}}function ct(e,t,n,r){var i=[],s=[],o=0,u=e.length;while(++o<u)i.push(n(e[o-1],e[o])),s.push(r(t[o-1],t[o]));return function(t){var n=d3.bisect(e,t,1,e.length-1)-1;return s[n](i[n](t))}}function ht(e,t){function n(n){return e(t(n))}var r=t.pow;return n.invert=function(t){return r(e.invert(t))},n.domain=function(i){return arguments.length?(t=i[0]<0?dt:pt,r=t.pow,e.domain(i.map(t)),n):e.domain().map(r)},n.nice=function(){return e.domain(nt(e.domain(),rt)),n},n.ticks=function(){var n=tt(e.domain()),i=[];if(n.every(isFinite)){var s=Math.floor(n[0]),o=Math.ceil(n[1]),u=Math.round(r(n[0])),a=Math.round(r(n[1]));if(t===dt){i.push(r(s));for(;s++<o;)for(var f=9;f>0;f--)i.push(r(s)*f)}else{for(;s<o;s++)for(var f=1;f<10;f++)i.push(r(s)*f);i.push(r(s))}for(s=0;i[s]<u;s++);for(o=i.length;i[o-1]>a;o--);i=i.slice(s,o)}return i},n.tickFormat=function(e,i){arguments.length<2&&(i=cr);if(arguments.length<1)return i;var s=e/n.ticks().length,o=t===dt?(u=-1e-15,Math.floor):(u=1e-15,Math.ceil),u;return function(e){return e/r(o(t(e)+u))<s?i(e):""}},n.copy=function(){return ht(e.copy(),t)},st(n,e)}function pt(e){return Math.log(e)/Math.LN10}function dt(e){return-Math.log(-e)/Math.LN10}function vt(e,t){function n(t){return e(r(t))}var r=mt(t),i=mt(1/t);return n.invert=function(t){return i(e.invert(t))},n.domain=function(t){return arguments.length?(e.domain(t.map(r)),n):e.domain().map(i)},n.ticks=function(e){return at(n.domain(),e)},n.tickFormat=function(e){return ft(n.domain(),e)},n.nice=function(){return n.domain(nt(n.domain(),ot))},n.exponent=function(e){if(!arguments.length)return t;var s=n.domain();return r=mt(t=e),i=mt(1/t),n.domain(s)},n.copy=function(){return vt(e.copy(),t)},st(n,e)}function mt(e){return function(t){return t<0?-Math.pow(-t,e):Math.pow(t,e)}}function gt(e,t){function n(t){return s[((i[t]||(i[t]=e.push(t)))-1)%s.length]}function r(t,n){return d3.range(e.length).map(function(e){return t+n*e})}var i,s,o;return n.domain=function(r){if(!arguments.length)return e;e=[],i={};var s=-1,o=r.length,u;while(++s<o)i[u=r[s]]||(i[u]=e.push(u));return n[t.t](t.x,t.p)},n.range=function(e){return arguments.length?(s=e,o=0,t={t:"range",x:e},n):s},n.rangePoints=function(i,u){arguments.length<2&&(u=0);var a=i[0],f=i[1],l=(f-a)/(e.length-1+u);return s=r(e.length<2?(a+f)/2:a+l*u/2,l),o=0,t={t:"rangePoints",x:i,p:u},n},n.rangeBands=function(i,u){arguments.length<2&&(u=0);var a=i[0],f=i[1],l=(f-a)/(e.length+u);return s=r(a+l*u,l),o=l*(1-u),t={t:"rangeBands",x:i,p:u},n},n.rangeRoundBands=function(i,u){arguments.length<2&&(u=0);var a=i[0],f=i[1],l=Math.floor((f-a)/(e.length+u));return s=r(a+Math.round((f-a-(e.length-u)*l)/2),l),o=Math.round(l*(1-u)),t={t:"rangeRoundBands",x:i,p:u},n},n.rangeBand=function(){return o},n.copy=function(){return gt(e,t)},n.domain(e)}function yt(e,t){function n(){var n=0,s=e.length,o=t.length;i=[];while(++n<o)i[n-1]=d3.quantile(e,n/o);return r}function r(e){return isNaN(e=+e)?NaN:t[d3.bisect(i,e)]}var i;return r.domain=function(t){return arguments.length?(e=t.filter(function(e){return!isNaN(e)}).sort(d3.ascending),n()):e},r.range=function(e){return arguments.length?(t=e,n()):t},r.quantiles=function(){return i},r.copy=function(){return yt(e,t)},n()}function bt(e,t,n){function r(t){return n[Math.max(0,Math.min(o,Math.floor(s*(t-e))))]}function i(){return s=n.length/(t-e),o=n.length-1,r}var s,o;return r.domain=function(n){return arguments.length?(e=+n[0],t=+n[n.length-1],i()):[e,t]},r.range=function(e){return arguments.length?(n=e,i()):n},r.copy=function(){return bt(e,t,n)},i()}function wt(e){return e.innerRadius}function Et(e){return e.outerRadius}function St(e){return e.startAngle}function xt(e){return e.endAngle}function Tt(e){function t(t){return t.length<1?null:"M"+s(e(Nt(this,t,n,r)),o)}var n=Ct,r=kt,i="linear",s=yr[i],o=.7;return t.x=function(e){return arguments.length?(n=e,t):n},t.y=function(e){return arguments.length?(r=e,t):r},t.interpolate=function(e){return arguments.length?(s=yr[i=e],t):i},t.tension=function(e){return arguments.length?(o=e,t):o},t}function Nt(e,t,n,r){var i=[],s=-1,o=t.length,u=typeof n=="function",a=typeof r=="function",f;if(u&&a)while(++s<o)i.push([n.call(e,f=t[s],s),r.call(e,f,s)]);else if(u)while(++s<o)i.push([n.call(e,t[s],s),r]);else if(a)while(++s<o)i.push([n,r.call(e,t[s],s)]);else while(++s<o)i.push([n,r]);return i}function Ct(e){return e[0]}function kt(e){return e[1]}function Lt(e){var t=0,n=e.length,r=e[0],i=[r[0],",",r[1]];while(++t<n)i.push("L",(r=e[t])[0],",",r[1]);return i.join("")}function At(e){var t=0,n=e.length,r=e[0],i=[r[0],",",r[1]];while(++t<n)i.push("V",(r=e[t])[1],"H",r[0]);return i.join("")}function Ot(e){var t=0,n=e.length,r=e[0],i=[r[0],",",r[1]];while(++t<n)i.push("H",(r=e[t])[0],"V",r[1]);return i.join("")}function Mt(e,t){return e.length<4?Lt(e):e[1]+Pt(e.slice(1,e.length-1),Ht(e,t))}function _t(e,t){return e.length<3?Lt(e):e[0]+Pt((e.push(e[0]),e),Ht([e[e.length-2]].concat(e,[e[1]]),t))}function Dt(e,t,n){return e.length<3?Lt(e):e[0]+Pt(e,Ht(e,t))}function Pt(e,t){if(t.length<1||e.length!=t.length&&e.length!=t.length+2)return Lt(e);var n=e.length!=t.length,r="",i=e[0],s=e[1],o=t[0],u=o,a=1;n&&(r+="Q"+(s[0]-o[0]*2/3)+","+(s[1]-o[1]*2/3)+","+s[0]+","+s[1],i=e[1],a=2);if(t.length>1){u=t[1],s=e[a],a++,r+="C"+(i[0]+o[0])+","+(i[1]+o[1])+","+(s[0]-u[0])+","+(s[1]-u[1])+","+s[0]+","+s[1];for(var f=2;f<t.length;f++,a++)s=e[a],u=t[f],r+="S"+(s[0]-u[0])+","+(s[1]-u[1])+","+s[0]+","+s[1]}if(n){var l=e[a];r+="Q"+(s[0]+u[0]*2/3)+","+(s[1]+u[1]*2/3)+","+l[0]+","+l[1]}return r}function Ht(e,t){var n=[],r=(1-t)/2,i,s=e[0],o=e[1],u=1,a=e.length;while(++u<a)i=s,s=o,o=e[u],n.push([r*(o[0]-i[0]),r*(o[1]-i[1])]);return n}function Bt(e){if(e.length<3)return Lt(e);var t=1,n=e.length,r=e[0],i=r[0],s=r[1],o=[i,i,i,(r=e[1])[0]],u=[s,s,s,r[1]],a=[i,",",s];Rt(a,o,u);while(++t<n)r=e[t],o.shift(),o.push(r[0]),u.shift(),u.push(r[1]),Rt(a,o,u);t=-1;while(++t<2)o.shift(),o.push(r[0]),u.shift(),u.push(r[1]),Rt(a,o,u);return a.join("")}function jt(e){if(e.length<4)return Lt(e);var t=[],n=-1,r=e.length,i,s=[0],o=[0];while(++n<3)i=e[n],s.push(i[0]),o.push(i[1]);t.push(qt(Er,s)+","+qt(Er,o)),--n;while(++n<r)i=e[n],s.shift(),s.push(i[0]),o.shift(),o.push(i[1]),Rt(t,s,o);return t.join("")}function Ft(e){var t,n=-1,r=e.length,i=r+4,s,o=[],u=[];while(++n<4)s=e[n%r],o.push(s[0]),u.push(s[1]);t=[qt(Er,o),",",qt(Er,u)],--n;while(++n<i)s=e[n%r],o.shift(),o.push(s[0]),u.shift(),u.push(s[1]),Rt(t,o,u);return t.join("")}function It(e,t){var n=e.length-1,r=e[0][0],i=e[0][1],s=e[n][0]-r,o=e[n][1]-i,u=-1,a,f;while(++u<=n)a=e[u],f=u/n,a[0]=t*a[0]+(1-t)*(r+f*s),a[1]=t*a[1]+(1-t)*(i+f*o);return Bt(e)}function qt(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]+e[3]*t[3]}function Rt(e,t,n){e.push("C",qt(br,t),",",qt(br,n),",",qt(wr,t),",",qt(wr,n),",",qt(Er,t),",",qt(Er,n))}function Ut(e,t){return(t[1]-e[1])/(t[0]-e[0])}function zt(e){var t=0,n=e.length-1,r=[],i=e[0],s=e[1],o=r[0]=Ut(i,s);while(++t<n)r[t]=o+(o=Ut(i=s,s=e[t+1]));return r[t]=o,r}function Wt(e){var t=[],n,r,i,s,o=zt(e),u=-1,a=e.length-1;while(++u<a)n=Ut(e[u],e[u+1]),Math.abs(n)<1e-6?o[u]=o[u+1]=0:(r=o[u]/n,i=o[u+1]/n,s=r*r+i*i,s>9&&(s=n*3/Math.sqrt(s),o[u]=s*r,o[u+1]=s*i));u=-1;while(++u<=a)s=(e[Math.min(a,u+1)][0]-e[Math.max(0,u-1)][0])/(6*(1+o[u]*o[u])),t.push([s||0,o[u]*s||0]);return t}function Xt(e){return e.length<3?Lt(e):e[0]+Pt(e,Wt(e))}function Vt(e){var t,n=-1,r=e.length,i,s;while(++n<r)t=e[n],i=t[0],s=t[1]+mr,t[0]=i*Math.cos(s),t[1]=i*Math.sin(s);return e}function $t(e){function t(t){if(t.length<1)return null;var o=Nt(this,t,n,i),l=Nt(this,t,n===r?Jt(o):r,i===s?Kt(o):s);return"M"+u(e(l),f)+"L"+a(e(o.reverse()),f)+"Z"}var n=Ct,r=Ct,i=0,s=kt,o,u,a,f=.7;return t.x=function(e){return arguments.length?(n=r=e,t):r},t.x0=function(e){return arguments.length?(n=e,t):n},t.x1=function(e){return arguments.length?(r=e,t):r},t.y=function(e){return arguments.length?(i=s=e,t):s},t.y0=function(e){return arguments.length?(i=e,t):i},t.y1=function(e){return arguments.length?(s=e,t):s},t.interpolate=function(e){return arguments.length?(u=yr[o=e],a=u.reverse||u,t):o},t.tension=function(e){return arguments.length?(f=e,t):f},t.interpolate("linear")}function Jt(e){return function(t,n){return e[n][0]}}function Kt(e){return function(t,n){return e[n][1]}}function Qt(e){return e.source}function Gt(e){return e.target}function Yt(e){return e.radius}function Zt(e){return e.startAngle}function en(e){return e.endAngle}function tn(e){return[e.x,e.y]}function nn(e){return function(){var t=e.apply(this,arguments),n=t[0],r=t[1]+mr;return[n*Math.cos(r),n*Math.sin(r)]}}function rn(e,t){var n=(e.ownerSVGElement||e).createSVGPoint();if(Sr<0&&(window.scrollX||window.scrollY)){var r=d3.select(document.body).append("svg:svg").style("position","absolute").style("top",0).style("left",0),i=r[0][0].getScreenCTM();Sr=!i.f&&!i.e,r.remove()}return Sr?(n.x=t.pageX,n.y=t.pageY):(n.x=t.clientX,n.y=t.clientY),n=n.matrixTransform(e.getScreenCTM().inverse()),[n.x,n.y]}function sn(){return 64}function on(){return"circle"}function un(e,t){e.attr("transform",function(e){return"translate("+t(e)+",0)"})}function an(e,t){e.attr("transform",function(e){return"translate(0,"+t(e)+")"})}function fn(e,t,n){i=[];if(n&&t.length>1){var r=tt(e.domain()),i,s=-1,o=t.length,u=(t[1]-t[0])/++n,a,f;while(++s<o)for(a=n;--a>0;)(f=+t[s]-a*u)>=r[0]&&i.push(f);for(--s,a=0;++a<n&&(f=+t[s]+a*u)<r[1];)i.push(f)}return i}function ln(e,t){e.select(".extent").attr("x",t[0][0]),e.selectAll(".n,.s,.w,.nw,.sw").attr("x",t[0][0]-2),e.selectAll(".e,.ne,.se").attr("x",t[1][0]-3),e.selectAll(".extent,.n,.s").attr("width",t[1][0]-t[0][0])}function cn(e,t){e.select(".extent").attr("y",t[0][1]),e.selectAll(".n,.e,.w,.nw,.ne").attr("y",t[0][1]-3),e.selectAll(".s,.se,.sw").attr("y",t[1][1]-4),e.selectAll(".extent,.e,.w").attr("height",t[1][1]-t[0][1])}function hn(){d3.event.keyCode==32&&Lr&&!_r&&(Pr=null,Hr[0]-=Mr[1][0],Hr[1]-=Mr[1][1],_r=2,T())}function pn(){d3.event.keyCode==32&&_r==2&&(Hr[0]+=Mr[1][0],Hr[1]+=Mr[1][1],_r=0,T())}function dn(){if(Hr){var e=d3.svg.mouse(Lr),t=d3.select(Lr);_r||(d3.event.altKey?(Pr||(Pr=[(Mr[0][0]+Mr[1][0])/2,(Mr[0][1]+Mr[1][1])/2]),Hr[0]=Mr[+(e[0]<Pr[0])][0],Hr[1]=Mr[+(e[1]<Pr[1])][1]):Pr=null),Ar&&(vn(e,Ar,0),ln(t,Mr)),Or&&(vn(e,Or,1),cn(t,Mr)),kr("brush")}}function vn(e,t,n){var r=tt(t.range()),i=Hr[n],s=Mr[1][n]-Mr[0][n],o,u;_r&&(r[0]-=i,r[1]-=s+i),o=Math.max(r[0],Math.min(r[1],e[n])),_r?u=(o+=i)+s:(Pr&&(i=Math.max(r[0],Math.min(r[1],2*Pr[n]-o))),i<o?(u=o,o=i):u=i),Mr[0][n]=o,Mr[1][n]=u}function mn(){Hr&&(dn(),d3.select(Lr).selectAll(".resize").style("pointer-events",Cr.empty()?"none":"all"),kr("brushend"),Cr=kr=Lr=Ar=Or=Mr=_r=Dr=Pr=Hr=null,T())}function gn(e){var t=d3.event,n=Ir.parentNode,r=0,i=0;n&&(n=yn(n),r=n[0]-Rr[0],i=n[1]-Rr[1],Rr=n,Ur|=r|i);try{d3.event={dx:r,dy:i},jr[e].apply(Ir,qr)}finally{d3.event=t}t.preventDefault()}function yn(e,t){var n=d3.event.changedTouches;return n?d3.svg.touches(e,n)[0]:d3.svg.mouse(e)}function bn(){if(!Ir)return;var e=Ir.parentNode;if(!e)return wn();gn("drag"),T()}function wn(){if(!Ir)return;gn("dragend"),Ir=null,Ur&&Fr===d3.event.target&&(zr=!0,T())}function En(){zr&&Fr===d3.event.target&&(T(),zr=!1,Fr=null)}function Sn(e){return[e[0]-Kr[0],e[1]-Kr[1],Kr[2]]}function xn(){Wr||(Wr=d3.select("body").append("div").style("visibility","hidden").style("top",0).style("height",0).style("width",0).style("overflow-y","scroll").append("div").style("height","2000px").node().parentNode);var e=d3.event,t;try{Wr.scrollTop=1e3,Wr.dispatchEvent(e),t=1e3-Wr.scrollTop}catch(n){t=e.wheelDelta||-e.detail*5}return t*.005}function Tn(){var e=d3.svg.touches(Zr),t=-1,n=e.length,r;while(++t<n)$r[(r=e[t]).identifier]=Sn(r);return e}function Nn(){var e=d3.svg.touches(Zr);switch(e.length){case 1:var t=e[0];An(Kr[2],t,$r[t.identifier]);break;case 2:var n=e[0],r=e[1],i=[(n[0]+r[0])/2,(n[1]+r[1])/2],s=$r[n.identifier],o=$r[r.identifier],u=[(s[0]+o[0])/2,(s[1]+o[1])/2,s[2]];An(Math.log(d3.event.scale)/Math.LN2+s[2],i,u)}}function Cn(){Vr=null,Xr&&(ti=!0,An(Kr[2],d3.svg.mouse(Zr),Xr))}function kn(){Xr&&(ti&&Yr===d3.event.target&&(ni=!0),Cn(),Xr=null)}function Ln(){ni&&Yr===d3.event.target&&(d3.event.stopPropagation(),d3.event.preventDefault(),ni=!1,Yr=null)}function An(e,t,n){function r(e,t,n){e.domain(e.range().map(function(r){return e.invert((r-n)*i/s+t)}))}e=On(e,2);var i=Math.pow(2,Kr[2]),s=Math.pow(2,e),o=Math.pow(2,(Kr[2]=e)-n[2]),u=Kr[0],a=Kr[1],f=Kr[0]=On(t[0]-n[0]*o,0,s),l=Kr[1]=On(t[1]-n[1]*o,1,s),c=d3.event;d3.event={scale:s,translate:[f,l],transform:function(e,t){e&&r(e,u,f),t&&r(t,a,l)}};try{Gr.apply(Zr,ei)}finally{d3.event=c}c.preventDefault()}function On(e,t,n){var r=Qr[t],i=r[0],s=r[1];return arguments.length===3?Math.max(s*(s===Infinity?-Infinity:1/n-1),Math.min(i===-Infinity?Infinity:i,e/n))*n:Math.max(i,Math.min(s,e))}Date.now||(Date.now=function(){return+(new Date)});try{document.createElement("div").style.setProperty("opacity",0,"")}catch(Mn){var _n=CSSStyleDeclaration.prototype,Dn=_n.setProperty;_n.setProperty=function(e,t,n){Dn.call(this,e,t+"",n)}}d3={version:"2.5.0"};var Pn=t;try{Pn(document.documentElement.childNodes)[0].nodeType}catch(Hn){Pn=e}var Bn=[].__proto__?function(e,t){e.__proto__=t}:function(e,t){for(var n in t)e[n]=t[n]};d3.functor=function(e){return typeof e=="function"?e:function(){return e}},d3.rebind=function(e,t){return function(){var n=t.apply(e,arguments);return arguments.length?e:n}},d3.ascending=function(e,t){return e<t?-1:e>t?1:e>=t?0:NaN},d3.descending=function(e,t){return t<e?-1:t>e?1:t>=e?0:NaN},d3.mean=function(e,t){var n=e.length,i,s=0,o=-1,u=0;if(arguments.length===1)while(++o<n)r(i=e[o])&&(s+=(i-s)/++u);else while(++o<n)r(i=t.call(e,e[o],o))&&(s+=(i-s)/++u);return u?s:undefined},d3.median=function(e,t){return arguments.length>1&&(e=e.map(t)),e=e.filter(r),e.length?d3.quantile(e.sort(d3.ascending),.5):undefined},d3.min=function(e,t){var n=-1,r=e.length,i,s;if(arguments.length===1){while(++n<r&&((i=e[n])==null||i!=i))i=undefined;while(++n<r)(s=e[n])!=null&&i>s&&(i=s)}else{while(++n<r&&((i=t.call(e,e[n],n))==null||i!=i))i=undefined;while(++n<r)(s=t.call(e,e[n],n))!=null&&i>s&&(i=s)}return i},d3.max=function(e,t){var n=-1,r=e.length,i,s;if(arguments.length===1){while(++n<r&&((i=e[n])==null||i!=i))i=undefined;while(++n<r)(s=e[n])!=null&&s>i&&(i=s)}else{while(++n<r&&((i=t.call(e,e[n],n))==null||i!=i))i=undefined;while(++n<r)(s=t.call(e,e[n],n))!=null&&s>i&&(i=s)}return i},d3.extent=function(e,t){var n=-1,r=e.length,i,s,o;if(arguments.length===1){while(++n<r&&((i=o=e[n])==null||i!=i))i=o=undefined;while(++n<r)(s=e[n])!=null&&(i>s&&(i=s),o<s&&(o=s))}else{while(++n<r&&((i=o=t.call(e,e[n],n))==null||i!=i))i=undefined;while(++n<r)(s=t.call(e,e[n],n))!=null&&(i>s&&(i=s),o<s&&(o=s))}return[i,o]},d3.random={normal:function(e,t){return arguments.length<2&&(t=1),arguments.length<1&&(e=0),function(){var n,r,i;do n=Math.random()*2-1,r=Math.random()*2-1,i=n*n+r*r;while(!i||i>1);return e+t*n*Math.sqrt(-2*Math.log(i)/i)}}},d3.sum=function(e,t){var n=0,r=e.length,i,s=-1;if(arguments.length===1)while(++s<r)isNaN(i=+e[s])||(n+=i);else while(++s<r)isNaN(i=+t.call(e,e[s],s))||(n+=i);return n},d3.quantile=function(e,t){var n=(e.length-1)*t+1,r=Math.floor(n),i=e[r-1],s=n-r;return s?i+s*(e[r]-i):i},d3.zip=function(){if(!(s=arguments.length))return[];for(var e=-1,t=d3.min(arguments,i),n=new Array(t);++e<t;)for(var r=-1,s,o=n[e]=new Array(s);++r<s;)o[r]=arguments[r][e];return n},d3.bisectLeft=function(e,t,n,r){arguments.length<3&&(n=0),arguments.length<4&&(r=e.length);while(n<r){var i=n+r>>1;e[i]<t?n=i+1:r=i}return n},d3.bisect=d3.bisectRight=function(e,t,n,r){arguments.length<3&&(n=0),arguments.length<4&&(r=e.length);while(n<r){var i=n+r>>1;t<e[i]?r=i:n=i+1}return n},d3.first=function(e,t){var n=0,r=e.length,i=e[0],s;arguments.length===1&&(t=d3.ascending);while(++n<r)t.call(e,i,s=e[n])>0&&(i=s);return i},d3.last=function(e,t){var n=0,r=e.length,i=e[0],s;arguments.length===1&&(t=d3.ascending);while(++n<r)t.call(e,i,s=e[n])<=0&&(i=s);return i},d3.nest=function(){function e(t,i){if(i>=r.length)return o?o.call(n,t):s?t.sort(s):t;var u=-1,a=t.length,f=r[i++],l,c,h={};while(++u<a)(l=f(c=t[u]))in h?h[l].push(c):h[l]=[c];for(l in h)h[l]=e(h[l],i);return h}function t(e,n){if(n>=r.length)return e;var s=[],o=i[n++],u;for(u in e)s.push({key
:u,values:t(e[u],n)});return o&&s.sort(function(e,t){return o(e.key,t.key)}),s}var n={},r=[],i=[],s,o;return n.map=function(t){return e(t,0)},n.entries=function(n){return t(e(n,0),0)},n.key=function(e){return r.push(e),n},n.sortKeys=function(e){return i[r.length-1]=e,n},n.sortValues=function(e){return s=e,n},n.rollup=function(e){return o=e,n},n},d3.keys=function(e){var t=[];for(var n in e)t.push(n);return t},d3.values=function(e){var t=[];for(var n in e)t.push(e[n]);return t},d3.entries=function(e){var t=[];for(var n in e)t.push({key:n,value:e[n]});return t},d3.permute=function(e,t){var n=[],r=-1,i=t.length;while(++r<i)n[r]=e[t[r]];return n},d3.merge=function(e){return Array.prototype.concat.apply([],e)},d3.split=function(e,t){var n=[],r=[],i,o=-1,u=e.length;arguments.length<2&&(t=s);while(++o<u)t.call(r,i=e[o],o)?r=[]:(r.length||n.push(r),r.push(i));return n},d3.range=function(e,t,n){arguments.length<3&&(n=1,arguments.length<2&&(t=e,e=0));if((t-e)/n==Infinity)throw new Error("infinite range");var r=[],i=-1,s;if(n<0)while((s=e+n*++i)>t)r.push(s);else while((s=e+n*++i)<t)r.push(s);return r},d3.requote=function(e){return e.replace(jn,"\\$&")};var jn=/[\\\^\$\*\+\?\|\[\]\(\)\.\{\}]/g;d3.round=function(e,t){return t?Math.round(e*Math.pow(10,t))*Math.pow(10,-t):Math.round(e)},d3.xhr=function(e,t,n){var r=new XMLHttpRequest;arguments.length<3?n=t:t&&r.overrideMimeType&&r.overrideMimeType(t),r.open("GET",e,!0),r.onreadystatechange=function(){r.readyState===4&&n(r.status<300?r:null)},r.send(null)},d3.text=function(e,t,n){function r(e){n(e&&e.responseText)}arguments.length<3&&(n=t,t=null),d3.xhr(e,t,r)},d3.json=function(e,t){d3.text(e,"application/json",function(e){t(e?JSON.parse(e):null)})},d3.html=function(e,t){d3.text(e,"text/html",function(e){if(e!=null){var n=document.createRange();n.selectNode(document.body),e=n.createContextualFragment(e)}t(e)})},d3.xml=function(e,t,n){function r(e){n(e&&e.responseXML)}arguments.length<3&&(n=t,t=null),d3.xhr(e,t,r)},d3.ns={prefix:{svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"},qualify:function(e){var t=e.indexOf(":");return t<0?e:{space:d3.ns.prefix[e.substring(0,t)],local:e.substring(t+1)}}},d3.dispatch=function(){var e=new u,t=-1,n=arguments.length;while(++t<n)e[arguments[t]]=a();return e},u.prototype.on=function(e,t){var n=e.indexOf("."),r="";n>0&&(r=e.substring(n+1),e=e.substring(0,n)),this[e].on(r,t)},d3.format=function(e){var t=Fn.exec(e),n=t[1]||" ",r=t[3]||"",i=t[5],s=+t[6],o=t[7],u=t[8],a=t[9],f=1,h="",p=!1;u&&(u=+u.substring(1)),i&&(n="0",o&&(s-=Math.floor((s-1)/4)));switch(a){case"n":o=!0,a="g";break;case"%":f=100,h="%",a="f";break;case"p":f=100,h="%",a="r";break;case"d":p=!0,u=0;break;case"s":f=-1,a="r"}return a=="r"&&!u&&(a="g"),a=In[a]||l,function(e){if(p&&e%1)return"";var t=e<0&&(e=-e)?"−":r;if(f<0){var l=d3.formatPrefix(e,u);e*=l.scale,h=l.symbol}else e*=f;e=a(e,u);if(i){var d=e.length+t.length;d<s&&(e=(new Array(s-d+1)).join(n)+e),o&&(e=c(e)),e=t+e}else{o&&(e=c(e)),e=t+e;var d=e.length;d<s&&(e=(new Array(s-d+1)).join(n)+e)}return e+h}};var Fn=/(?:([^{])?([<>=^]))?([+\- ])?(#)?(0)?([0-9]+)?(,)?(\.[0-9]+)?([a-zA-Z%])?/,In={g:function(e,t){return e.toPrecision(t)},e:function(e,t){return e.toExponential(t)},f:function(e,t){return e.toFixed(t)},r:function(e,t){return d3.round(e,t=f(e,t)).toFixed(Math.max(0,Math.min(20,t)))}},qn=["y","z","a","f","p","n","μ","m","","k","M","G","T","P","E","Z","Y"].map(h);d3.formatPrefix=function(e,t){var n=0;return e&&(e<0&&(e*=-1),t&&(e=d3.round(e,f(e,t))),n=1+Math.floor(1e-12+Math.log(e)/Math.LN10),n=Math.max(-24,Math.min(24,Math.floor((n<=0?n+1:n-1)/3)*3))),qn[8+n/3]};var Rn=g(2),Un=g(3),zn={linear:function(){return m},poly:g,quad:function(){return Rn},cubic:function(){return Un},sin:function(){return y},exp:function(){return b},circle:function(){return w},elastic:E,back:S,bounce:function(){return x}},Wn={"in":function(e){return e},out:d,"in-out":v,"out-in":function(e){return v(d(e))}};d3.ease=function(e){var t=e.indexOf("-"),n=t>=0?e.substring(0,t):e,r=t>=0?e.substring(t+1):"in";return p(Wn[r](zn[n].apply(null,Array.prototype.slice.call(arguments,1))))},d3.event=null,d3.interpolate=function(e,t){var n=d3.interpolators.length,r;while(--n>=0&&!(r=d3.interpolators[n](e,t)));return r},d3.interpolateNumber=function(e,t){return t-=e,function(n){return e+t*n}},d3.interpolateRound=function(e,t){return t-=e,function(n){return Math.round(e+t*n)}},d3.interpolateString=function(e,t){var n,r,i,s=0,o=0,u=[],a=[],f,l;Xn.lastIndex=0;for(r=0;n=Xn.exec(t);++r)n.index&&u.push(t.substring(s,o=n.index)),a.push({i:u.length,x:n[0]}),u.push(null),s=Xn.lastIndex;s<t.length&&u.push(t.substring(s));for(r=0,f=a.length;(n=Xn.exec(e))&&r<f;++r){l=a[r];if(l.x==n[0]){if(l.i)if(u[l.i+1]==null){u[l.i-1]+=l.x,u.splice(l.i,1);for(i=r+1;i<f;++i)a[i].i--}else{u[l.i-1]+=l.x+u[l.i+1],u.splice(l.i,2);for(i=r+1;i<f;++i)a[i].i-=2}else if(u[l.i+1]==null)u[l.i]=l.x;else{u[l.i]=l.x+u[l.i+1],u.splice(l.i+1,1);for(i=r+1;i<f;++i)a[i].i--}a.splice(r,1),f--,r--}else l.x=d3.interpolateNumber(parseFloat(n[0]),parseFloat(l.x))}while(r<f)l=a.pop(),u[l.i+1]==null?u[l.i]=l.x:(u[l.i]=l.x+u[l.i+1],u.splice(l.i+1,1)),f--;return u.length===1?u[0]==null?a[0].x:function(){return t}:function(e){for(r=0;r<f;++r)u[(l=a[r]).i]=l.x(e);return u.join("")}},d3.interpolateTransform=function(e,t){return d3.interpolateString(d3.transform(e)+"",d3.transform(t)+"")},d3.interpolateRgb=function(e,t){e=d3.rgb(e),t=d3.rgb(t);var n=e.r,r=e.g,i=e.b,s=t.r-n,o=t.g-r,u=t.b-i;return function(e){return"#"+O(Math.round(n+s*e))+O(Math.round(r+o*e))+O(Math.round(i+u*e))}},d3.interpolateHsl=function(e,t){e=d3.hsl(e),t=d3.hsl(t);var n=e.h,r=e.s,i=e.l,s=t.h-n,o=t.s-r,u=t.l-i;return function(e){return B(n+s*e,r+o*e,i+u*e).toString()}},d3.interpolateArray=function(e,t){var n=[],r=[],i=e.length,s=t.length,o=Math.min(e.length,t.length),u;for(u=0;u<o;++u)n.push(d3.interpolate(e[u],t[u]));for(;u<i;++u)r[u]=e[u];for(;u<s;++u)r[u]=t[u];return function(e){for(u=0;u<o;++u)r[u]=n[u](e);return r}},d3.interpolateObject=function(e,t){var n={},r={},i;for(i in e)i in t?n[i]=N(i)(e[i],t[i]):r[i]=e[i];for(i in t)i in e||(r[i]=t[i]);return function(e){for(i in n)r[i]=n[i](e);return r}};var Xn=/[-+]?(?:\d*\.?\d+)(?:[eE][-+]?\d+)?/g;d3.interpolators=[d3.interpolateObject,function(e,t){return t instanceof Array&&d3.interpolateArray(e,t)},function(e,t){return typeof t=="string"&&d3.interpolateString(e+"",t)},function(e,t){return(typeof t=="string"?t in Vn||/^(#|rgb\(|hsl\()/.test(t):t instanceof A||t instanceof H)&&d3.interpolateRgb(e+"",t)},function(e,t){return typeof t=="number"&&d3.interpolateNumber(+e,t)}],d3.rgb=function(e,t,n){return arguments.length===1?e instanceof A?L(e.r,e.g,e.b):M(""+e,L,B):L(~~e,~~t,~~n)},A.prototype.brighter=function(e){e=Math.pow(.7,arguments.length?e:1);var t=this.r,n=this.g,r=this.b,i=30;return!t&&!n&&!r?L(i,i,i):(t&&t<i&&(t=i),n&&n<i&&(n=i),r&&r<i&&(r=i),L(Math.min(255,Math.floor(t/e)),Math.min(255,Math.floor(n/e)),Math.min(255,Math.floor(r/e))))},A.prototype.darker=function(e){return e=Math.pow(.7,arguments.length?e:1),L(Math.floor(e*this.r),Math.floor(e*this.g),Math.floor(e*this.b))},A.prototype.hsl=function(){return _(this.r,this.g,this.b)},A.prototype.toString=function(){return"#"+O(this.r)+O(this.g)+O(this.b)};var Vn={aliceblue:"#f0f8ff",antiquewhite:"#faebd7",aqua:"#00ffff",aquamarine:"#7fffd4",azure:"#f0ffff",beige:"#f5f5dc",bisque:"#ffe4c4",black:"#000000",blanchedalmond:"#ffebcd",blue:"#0000ff",blueviolet:"#8a2be2",brown:"#a52a2a",burlywood:"#deb887",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",cornflowerblue:"#6495ed",cornsilk:"#fff8dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkgray:"#a9a9a9",darkgreen:"#006400",darkgrey:"#a9a9a9",darkkhaki:"#bdb76b",darkmagenta:"#8b008b",darkolivegreen:"#556b2f",darkorange:"#ff8c00",darkorchid:"#9932cc",darkred:"#8b0000",darksalmon:"#e9967a",darkseagreen:"#8fbc8f",darkslateblue:"#483d8b",darkslategray:"#2f4f4f",darkslategrey:"#2f4f4f",darkturquoise:"#00ced1",darkviolet:"#9400d3",deeppink:"#ff1493",deepskyblue:"#00bfff",dimgray:"#696969",dimgrey:"#696969",dodgerblue:"#1e90ff",firebrick:"#b22222",floralwhite:"#fffaf0",forestgreen:"#228b22",fuchsia:"#ff00ff",gainsboro:"#dcdcdc",ghostwhite:"#f8f8ff",gold:"#ffd700",goldenrod:"#daa520",gray:"#808080",green:"#008000",greenyellow:"#adff2f",grey:"#808080",honeydew:"#f0fff0",hotpink:"#ff69b4",indianred:"#cd5c5c",indigo:"#4b0082",ivory:"#fffff0",khaki:"#f0e68c",lavender:"#e6e6fa",lavenderblush:"#fff0f5",lawngreen:"#7cfc00",lemonchiffon:"#fffacd",lightblue:"#add8e6",lightcoral:"#f08080",lightcyan:"#e0ffff",lightgoldenrodyellow:"#fafad2",lightgray:"#d3d3d3",lightgreen:"#90ee90",lightgrey:"#d3d3d3",lightpink:"#ffb6c1",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",lightskyblue:"#87cefa",lightslategray:"#778899",lightslategrey:"#778899",lightsteelblue:"#b0c4de",lightyellow:"#ffffe0",lime:"#00ff00",limegreen:"#32cd32",linen:"#faf0e6",magenta:"#ff00ff",maroon:"#800000",mediumaquamarine:"#66cdaa",mediumblue:"#0000cd",mediumorchid:"#ba55d3",mediumpurple:"#9370db",mediumseagreen:"#3cb371",mediumslateblue:"#7b68ee",mediumspringgreen:"#00fa9a",mediumturquoise:"#48d1cc",mediumvioletred:"#c71585",midnightblue:"#191970",mintcream:"#f5fffa",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",navajowhite:"#ffdead",navy:"#000080",oldlace:"#fdf5e6",olive:"#808000",olivedrab:"#6b8e23",orange:"#ffa500",orangered:"#ff4500",orchid:"#da70d6",palegoldenrod:"#eee8aa",palegreen:"#98fb98",paleturquoise:"#afeeee",palevioletred:"#db7093",papayawhip:"#ffefd5",peachpuff:"#ffdab9",peru:"#cd853f",pink:"#ffc0cb",plum:"#dda0dd",powderblue:"#b0e0e6",purple:"#800080",red:"#ff0000",rosybrown:"#bc8f8f",royalblue:"#4169e1",saddlebrown:"#8b4513",salmon:"#fa8072",sandybrown:"#f4a460",seagreen:"#2e8b57",seashell:"#fff5ee",sienna:"#a0522d",silver:"#c0c0c0",skyblue:"#87ceeb",slateblue:"#6a5acd",slategray:"#708090",slategrey:"#708090",snow:"#fffafa",springgreen:"#00ff7f",steelblue:"#4682b4",tan:"#d2b48c",teal:"#008080",thistle:"#d8bfd8",tomato:"#ff6347",turquoise:"#40e0d0",violet:"#ee82ee",wheat:"#f5deb3",white:"#ffffff",whitesmoke:"#f5f5f5",yellow:"#ffff00",yellowgreen:"#9acd32"};for(var $n in Vn)Vn[$n]=M(Vn[$n],L,B);d3.hsl=function(e,t,n){return arguments.length===1?e instanceof H?P(e.h,e.s,e.l):M(""+e,_,P):P(+e,+t,+n)},H.prototype.brighter=function(e){return e=Math.pow(.7,arguments.length?e:1),P(this.h,this.s,this.l/e)},H.prototype.darker=function(e){return e=Math.pow(.7,arguments.length?e:1),P(this.h,this.s,e*this.l)},H.prototype.rgb=function(){return B(this.h,this.s,this.l)},H.prototype.toString=function(){return this.rgb().toString()};var Jn=function(e,t){return t.querySelector(e)},Kn=function(e,t){return t.querySelectorAll(e)};typeof Sizzle=="function"&&(Jn=function(e,t){return Sizzle(e,t)[0]},Kn=function(e,t){return Sizzle.uniqueSort(Sizzle(e,t))});var Qn=[];d3.selection=function(){return Yn},d3.selection.prototype=Qn,Qn.select=function(e){var t=[],n,r,i,s;typeof e!="function"&&(e=F(e));for(var o=-1,u=this.length;++o<u;){t.push(n=[]),n.parentNode=(i=this[o]).parentNode;for(var a=-1,f=i.length;++a<f;)(s=i[a])?(n.push(r=e.call(s,s.__data__,a)),r&&"__data__"in s&&(r.__data__=s.__data__)):n.push(null)}return j(t)},Qn.selectAll=function(e){var t=[],n,r;typeof e!="function"&&(e=I(e));for(var i=-1,s=this.length;++i<s;)for(var o=this[i],u=-1,a=o.length;++u<a;)if(r=o[u])t.push(n=Pn(e.call(r,r.__data__,u))),n.parentNode=r;return j(t)},Qn.attr=function(e,t){function n(){this.removeAttribute(e)}function r(){this.removeAttributeNS(e.space,e.local)}function i(){this.setAttribute(e,t)}function s(){this.setAttributeNS(e.space,e.local,t)}function o(){var n=t.apply(this,arguments);n==null?this.removeAttribute(e):this.setAttribute(e,n)}function u(){var n=t.apply(this,arguments);n==null?this.removeAttributeNS(e.space,e.local):this.setAttributeNS(e.space,e.local,n)}e=d3.ns.qualify(e);if(arguments.length<2){var a=this.node();return e.local?a.getAttributeNS(e.space,e.local):a.getAttribute(e)}return this.each(t==null?e.local?r:n:typeof t=="function"?e.local?u:o:e.local?s:i)},Qn.classed=function(e,t){var n=e.split(Gn),r=n.length,i=-1;if(arguments.length>1){while(++i<r)q.call(this,n[i],t);return this}while(++i<r)if(!q.call(this,n[i]))return!1;return!0};var Gn=/\s+/g;Qn.style=function(e,t,n){function r(){this.style.removeProperty(e)}function i(){this.style.setProperty(e,t,n)}function s(){var r=t.apply(this,arguments);r==null?this.style.removeProperty(e):this.style.setProperty(e,r,n)}return arguments.length<3&&(n=""),arguments.length<2?window.getComputedStyle(this.node(),null).getPropertyValue(e):this.each(t==null?r:typeof t=="function"?s:i)},Qn.property=function(e,t){function n(){delete this[e]}function r(){this[e]=t}function i(){var n=t.apply(this,arguments);n==null?delete this[e]:this[e]=n}return arguments.length<2?this.node()[e]:this.each(t==null?n:typeof t=="function"?i:r)},Qn.text=function(e){return arguments.length<1?this.node().textContent:this.each(typeof e=="function"?function(){this.textContent=e.apply(this,arguments)}:function(){this.textContent=e})},Qn.html=function(e){return arguments.length<1?this.node().innerHTML:this.each(typeof e=="function"?function(){this.innerHTML=e.apply(this,arguments)}:function(){this.innerHTML=e})},Qn.append=function(e){function t(){return this.appendChild(document.createElement(e))}function n(){return this.appendChild(document.createElementNS(e.space,e.local))}return e=d3.ns.qualify(e),this.select(e.local?n:t)},Qn.insert=function(e,t){function n(){return this.insertBefore(document.createElement(e),Jn(t,this))}function r(){return this.insertBefore(document.createElementNS(e.space,e.local),Jn(t,this))}return e=d3.ns.qualify(e),this.select(e.local?r:n)},Qn.remove=function(){return this.each(function(){var e=this.parentNode;e&&e.removeChild(this)})},Qn.data=function(e,t){function n(e,n){var o,u=e.length,a=n.length,f=Math.min(u,a),l=Math.max(u,a),c=[],h=[],p=[],d,v;if(t){var m={},g=[],y,b=n.length;for(o=-1;++o<u;)y=t.call(d=e[o],d.__data__,o),y in m?p[b++]=d:m[y]=d,g.push(y);for(o=-1;++o<a;)d=m[y=t.call(n,v=n[o],o)],d?(d.__data__=v,c[o]=d,h[o]=p[o]=null):(h[o]=R(v),c[o]=p[o]=null),delete m[y];for(o=-1;++o<u;)g[o]in m&&(p[o]=e[o])}else{for(o=-1;++o<f;)d=e[o],v=n[o],d?(d.__data__=v,c[o]=d,h[o]=p[o]=null):(h[o]=R(v),c[o]=p[o]=null);for(;o<a;++o)h[o]=R(n[o]),c[o]=p[o]=null;for(;o<l;++o)p[o]=e[o],h[o]=c[o]=null}h.update=c,h.parentNode=c.parentNode=p.parentNode=e.parentNode,r.push(h),i.push(c),s.push(p)}var r=[],i=[],s=[],o=-1,u=this.length,a;if(typeof e=="function")while(++o<u)n(a=this[o],e.call(a,a.parentNode.__data__,o));else while(++o<u)n(a=this[o],e);var f=j(i);return f.enter=function(){return z(r)},f.exit=function(){return j(s)},f},Qn.filter=function(e){var t=[],n,r,i;for(var s=0,o=this.length;s<o;s++){t.push(n=[]),n.parentNode=(r=this[s]).parentNode;for(var u=0,a=r.length;u<a;u++)(i=r[u])&&e.call(i,i.__data__,u)&&n.push(i)}return j(t)},Qn.map=function(e){return this.each(function(){this.__data__=e.apply(this,arguments)})},Qn.sort=function(e){e=U.apply(this,arguments);for(var t=0,n=this.length;t<n;t++)for(var r=this[t].sort(e),i=1,s=r.length,o=r[0];i<s;i++){var u=r[i];u&&(o&&o.parentNode.insertBefore(u,o.nextSibling),o=u)}return this},Qn.on=function(e,t,n){arguments.length<3&&(n=!1);var r="__on"+e,i=e.indexOf(".");return i>0&&(e=e.substring(0,i)),arguments.length<2?(i=this.node()[r])&&i._:this.each(function(i,s){function o(e){var n=d3.event;d3.event=e;try{t.call(u,u.__data__,s)}finally{d3.event=n}}var u=this;u[r]&&u.removeEventListener(e,u[r],n),t&&u.addEventListener(e,u[r]=o,n),o._=t})},Qn.each=function(e){for(var t=-1,n=this.length;++t<n;)for(var r=this[t],i=-1,s=r.length;++i<s;){var o=r[i];o&&e.call(o,o.__data__,i,t)}return this},Qn.call=function(e){return e.apply(this,(arguments[0]=this,arguments)),this},Qn.empty=function(){return!this.node()},Qn.node=function(e){for(var t=0,n=this.length;t<n;t++)for(var r=this[t],i=0,s=r.length;i<s;i++){var o=r[i];if(o)return o}return null},Qn.transition=function(){var e=[],t,n;for(var r=-1,i=this.length;++r<i;){e.push(t=[]);for(var s=this[r],o=-1,u=s.length;++o<u;)t.push((n=s[o])?{node:n,delay:0,duration:250}:null)}return W(e,rr||++nr,Date.now())};var Yn=j([[document]]);Yn[0].parentNode=document.documentElement,d3.select=function(e){return typeof e=="string"?Yn.select(e):j([[e]])},d3.selectAll=function(e){return typeof e=="string"?Yn.selectAll(e):j([Pn(e)])};var Zn=[];Zn.append=Qn.append,Zn.insert=Qn.insert,Zn.empty=Qn.empty,Zn.node=Qn.node,Zn.select=function(e){var t=[],n,r,i,s,o;for(var u=-1,a=this.length;++u<a;){i=(s=this[u]).update,t.push(n=[]),n.parentNode=s.parentNode;for(var f=-1,l=s.length;++f<l;)(o=s[f])?(n.push(i[f]=r=e.call(s.parentNode,o.__data__,f)),r.__data__=o.__data__):n.push(null)}return j(t)};var er={},tr=[],nr=0,rr=0,ir=d3.ease("cubic-in-out");tr.call=Qn.call,d3.transition=function(){return Yn.transition()},d3.transition.prototype=tr,tr.select=function(e){var t=[],n,r,i;typeof e!="function"&&(e=F(e));for(var s=-1,o=this.length;++s<o;){t.push(n=[]);for(var u=this[s],a=-1,f=u.length;++a<f;)(i=u[a])&&(r=e.call(i.node,i.node.__data__,a))?("__data__"in i.node&&(r.__data__=i.node.__data__),n.push({node:r,delay:i.delay,duration:i.duration})):n.push(null)}return W(t,this.id,this.time).ease(this.ease())},tr.selectAll=function(e){var t=[],n,r,i;typeof e!="function"&&(e=I(e));for(var s=-1,o=this.length;++s<o;)for(var u=this[s],a=-1,f=u.length;++a<f;)if(i=u[a]){r=e.call(i.node,i.node.__data__,a),t.push(n=[]);for(var l=-1,c=r.length;++l<c;)n.push({node:r[l],delay:i.delay,duration:i.duration})}return W(t,this.id,this.time).ease(this.ease())},tr.attr=function(e,t){return this.attrTween(e,V(e,t))},tr.attrTween=function(e,t){function n(e,n){var r=t.call(this,e,n,this.getAttribute(i));return r===er?(this.removeAttribute(i),null):r&&function(e){this.setAttribute(i,r(e))}}function r(e,n){var r=t.call(this,e,n,this.getAttributeNS(i.space,i.local));return r===er?(this.removeAttributeNS(i.space,i.local),null):r&&function(e){this.setAttributeNS(i.space,i.local,r(e))}}var i=d3.ns.qualify(e);return this.tween("attr."+e,i.local?r:n)},tr.style=function(e,t,n){return arguments.length<3&&(n=""),this.styleTween(e,V(e,t),n)},tr.styleTween=function(e,t,n){return arguments.length<3&&(n=""),this.tween("style."+e,function(r,i){var s=t.call(this,r,i,window.getComputedStyle(this,null).getPropertyValue(e));return s===er?(this.style.removeProperty(e),null):s&&function(t){this.style.setProperty(e,s(t),n)}})},tr.text=function(e){return this.tween("text",function(t,n){this.textContent=typeof e=="function"?e.call(this,t,n):e})},tr.remove=function(){return this.each("end",function(){var e;!this.__transition__&&(e=this.parentNode)&&e.removeChild(this)})},tr.delay=function(e){var t=this;return t.each(typeof e=="function"?function(n,r,i){t[i][r].delay=+e.apply(this,arguments)}:(e=+e,function(n,r,i){t[i][r].delay=e}))},tr.duration=function(e){var t=this;return t.each(typeof e=="function"?function(n,r,i){t[i][r].duration=+e.apply(this,arguments)}:(e=+e,function(n,r,i){t[i][r].duration=e}))},tr.transition=function(){return this.select(n)};var sr=null,or,ur;d3.timer=function(e,t,n){var r=!1,i,s=sr;if(arguments.length<3){if(arguments.length<2)t=0;else if(!isFinite(t))return;n=Date.now()}while(s){if(s.callback===e){s.then=n,s.delay=t,r=!0;break}i=s,s=s.next}r||(sr={callback:e,then:n,delay:t,next:sr}),or||(ur=clearTimeout(ur),or=1,ar(J))},d3.timer.flush=function(){var e,t=Date.now(),n=sr;while(n)e=t-n.then,n.delay||(n.flush=n.callback(e)),n=n.next;K()};var ar=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(e){setTimeout(e,17)};d3.transform=function(e){return fr.setAttribute("transform",e),new Q(fr.transform.baseVal.consolidate().matrix)},Q.prototype.toString=function(){return"translate("+this.translate+")rotate("+this.rotate+")skewX("+this.skew+")scale("+this.scale+")"};var fr=document.createElementNS(d3.ns.prefix.svg,"g"),lr=180/Math.PI;d3.scale={},d3.scale.linear=function(){return it([0,1],[0,1],d3.interpolate,!1)},d3.scale.log=function(){return ht(d3.scale.linear(),pt)};var cr=d3.format("e");pt.pow=function(e){return Math.pow(10,e)},dt.pow=function(e){return-Math.pow(10,-e)},d3.scale.pow=function(){return vt(d3.scale.linear(),1)},d3.scale.sqrt=function(){return d3.scale.pow().exponent(.5)},d3.scale.ordinal=function(){return gt([],{t:"range",x:[]})},d3.scale.category10=function(){return d3.scale.ordinal().range(hr)},d3.scale.category20=function(){return d3.scale.ordinal().range(pr)},d3.scale.category20b=function(){return d3.scale.ordinal().range(dr)},d3.scale.category20c=function(){return d3.scale.ordinal().range(vr)};var hr=["#1f77b4","#ff7f0e","#2ca02c","#d62728","#9467bd","#8c564b","#e377c2","#7f7f7f","#bcbd22","#17becf"],pr=["#1f77b4","#aec7e8","#ff7f0e","#ffbb78","#2ca02c","#98df8a","#d62728","#ff9896","#9467bd","#c5b0d5","#8c564b","#c49c94","#e377c2","#f7b6d2","#7f7f7f","#c7c7c7","#bcbd22","#dbdb8d","#17becf","#9edae5"],dr=["#393b79","#5254a3","#6b6ecf","#9c9ede","#637939","#8ca252","#b5cf6b","#cedb9c","#8c6d31","#bd9e39","#e7ba52","#e7cb94","#843c39","#ad494a","#d6616b","#e7969c","#7b4173","#a55194","#ce6dbd","#de9ed6"],vr=["#3182bd","#6baed6","#9ecae1","#c6dbef","#e6550d","#fd8d3c","#fdae6b","#fdd0a2","#31a354","#74c476","#a1d99b","#c7e9c0","#756bb1","#9e9ac8","#bcbddc","#dadaeb","#636363","#969696","#bdbdbd","#d9d9d9"];d3.scale.quantile=function(){return yt([],[])},d3.scale.quantize=function(){return bt(0,1,[0,1])},d3.svg={},d3.svg.arc=function(){function e(){var e=t.apply(this,arguments),s=n.apply(this,arguments),o=r.apply(this,arguments)+mr,u=i.apply(this,arguments)+mr,a=(u<o&&(a=o,o=u,u=a),u-o),f=a<Math.PI?"0":"1",l=Math.cos(o),c=Math.sin(o),h=Math.cos(u),p=Math.sin(u);return a>=gr?e?"M0,"+s+"A"+s+","+s+" 0 1,1 0,"+ -s+"A"+s+","+s+" 0 1,1 0,"+s+"M0,"+e+"A"+e+","+e+" 0 1,0 0,"+ -e+"A"+e+","+e+" 0 1,0 0,"+e+"Z":"M0,"+s+"A"+s+","+s+" 0 1,1 0,"+ -s+"A"+s+","+s+" 0 1,1 0,"+s+"Z":e?"M"+s*l+","+s*c+"A"+s+","+s+" 0 "+f+",1 "+s*h+","+s*p+"L"+e*h+","+e*p+"A"+e+","+e+" 0 "+f+",0 "+e*l+","+e*c+"Z":"M"+s*l+","+s*c+"A"+s+","+s+" 0 "+f+",1 "+s*h+","+s*p+"L0,0"+"Z"}var t=wt,n=Et,r=St,i=xt;return e.innerRadius=function(n){return arguments.length?(t=d3.functor(n),e):t},e.outerRadius=function(t){return arguments.length?(n=d3.functor(t),e):n},e.startAngle=function(t){return arguments.length?(r=d3.functor(t),e):r},e.endAngle=function(t){return arguments.length?(i=d3.functor(t),e):i},e.centroid=function(){var e=(t.apply(this,arguments)+n.apply(this,arguments))/2,s=(r.apply(this,arguments)+i.apply(this,arguments))/2+mr;return[Math.cos(s)*e,Math.sin(s)*e]},e};var mr=-Math.PI/2,gr=2*Math.PI-1e-6;d3.svg.line=function(){return Tt(Object)};var yr={linear:Lt,"step-before":At,"step-after":Ot,basis:Bt,"basis-open":jt,"basis-closed":Ft,bundle:It,cardinal:Dt,"cardinal-open":Mt,"cardinal-closed":_t,monotone:Xt},br=[0,2/3,1/3,0],wr=[0,1/3,2/3,0],Er=[0,1/6,2/3,1/6];d3.svg.line.radial=function(){var e=Tt(Vt);return e.radius=e.x,delete e.x,e.angle=e.y,delete e.y,e},At.reverse=Ot,Ot.reverse=At,d3.svg.area=function(){return $t(Object)},d3.svg.area.radial=function(){var e=$t(Vt);return e.radius=e.x,delete e.x,e.innerRadius=e.x0,delete e.x0,e.outerRadius=e.x1,delete e.x1,e.angle=e.y,delete e.y,e.startAngle=e.y0,delete e.y0,e.endAngle=e.y1,delete e.y1,e},d3.svg.chord=function(){function e(e,u){var a=t(this,s,e,u),f=t(this,o,e,u);return"M"+a.p0+r(a.r,a.p1)+(n(a,f)?i(a.r,a.p1,a.r,a.p0):i(a.r,a.p1,f.r,f.p0)+r(f.r,f.p1)+i(f.r,f.p1,a.r,a.p0))+"Z"}function t(e,t,n,r){var i=t.call(e,n,r),s=u.call(e,i,r),o=a.call(e,i,r)+mr,l=f.call(e,i,r)+mr;return{r:s,a0:o,a1:l,p0:[s*Math.cos(o),s*Math.sin(o)],p1:[s*Math.cos(l),s*Math.sin(l)]}}function n(e,t){return e.a0==t.a0&&e.a1==t.a1}function r(e,t){return"A"+e+","+e+" 0 0,1 "+t}function i(e,t,n,r){return"Q 0,0 "+r}var s=Qt,o=Gt,u=Yt,a=St,f=xt;return e.radius=function(t){return arguments.length?(u=d3.functor(t),e):u},e.source=function(t){return arguments.length?(s=d3.functor(t),e):s},e.target=function(t){return arguments.length?(o=d3.functor(t),e):o},e.startAngle=function(t){return arguments.length?(a=d3.functor(t),e):a},e.endAngle=function(t){return arguments.length?(f=d3.functor(t),e):f},e},d3.svg.diagonal=function(){function e(e,i){var s=t.call(this,e,i),o=n.call(this,e,i),u=(s.y+o.y)/2,a=[s,{x:s.x,y:u},{x:o.x,y:u},o];return a=a.map(r),"M"+a[0]+"C"+a[1]+" "+a[2]+" "+a[3]}var t=Qt,n=Gt,r=tn;return e.source=function(n){return arguments.length?(t=d3.functor(n),e):t},e.target=function(t){return arguments.length?(n=d3.functor(t),e):n},e.projection=function(t){return arguments.length?(r=t,e):r},e},d3.svg.diagonal.radial=function(){var e=d3.svg.diagonal(),t=tn,n=e.projection;return e.projection=function(e){return arguments.length?n(nn(t=e)):t},e},d3.svg.mouse=function(e){return rn(e,d3.event)};var Sr=/WebKit/.test(navigator.userAgent)?-1:0;d3.svg.touches=function(e,t){return arguments.length<2&&(t=d3.event.touches),t?Pn(t).map(function(t){var n=rn(e,t);return n.identifier=t.identifier,n}):[]},d3.svg.symbol=function(){function e(e,r){return(xr[t.call(this,e,r)]||xr.circle)(n.call(this,e,r))}var t=on,n=sn;return e.type=function(n){return arguments.length?(t=d3.functor(n),e):t},e.size=function(t){return arguments.length?(n=d3.functor(t),e):n},e};var xr={circle:function(e){var t=Math.sqrt(e/Math.PI);return"M0,"+t+"A"+t+","+t+" 0 1,1 0,"+ -t+"A"+t+","+t+" 0 1,1 0,"+t+"Z"},cross:function(e){var t=Math.sqrt(e/5)/2;return"M"+ -3*t+","+ -t+"H"+ -t+"V"+ -3*t+"H"+t+"V"+ -t+"H"+3*t+"V"+t+"H"+t+"V"+3*t+"H"+ -t+"V"+t+"H"+ -3*t+"Z"},diamond:function(e){var t=Math.sqrt(e/(2*Nr)),n=t*Nr;return"M0,"+ -t+"L"+n+",0"+" 0,"+t+" "+ -n+",0"+"Z"},square:function(e){var t=Math.sqrt(e)/2;return"M"+ -t+","+ -t+"L"+t+","+ -t+" "+t+","+t+" "+ -t+","+t+"Z"},"triangle-down":function(e){var t=Math.sqrt(e/Tr),n=t*Tr/2;return"M0,"+n+"L"+t+","+ -n+" "+ -t+","+ -n+"Z"},"triangle-up":function(e){var t=Math.sqrt(e/Tr),n=t*Tr/2;return"M0,"+ -n+"L"+t+","+n+" "+ -t+","+n+"Z"}};d3.svg.symbolTypes=d3.keys(xr);var Tr=Math.sqrt(3),Nr=Math.tan(30*Math.PI/180);d3.svg.axis=function(){function e(e){e.each(function(l,c,h){var p=d3.select(this),d=e.delay?function(t){var n=rr;try{return rr=e.id,t.transition().delay(e[h][c].delay).duration(e[h][c].duration).ease(e.ease())}finally{rr=n}}:Object,v=t.ticks.apply(t,u),m=a==null?t.tickFormat.apply(t,u):a,g=fn(t,v,f),y=p.selectAll(".minor").data(g,String),b=y.enter().insert("svg:line","g").attr("class","tick minor").style("opacity",1e-6),w=d(y.exit()).style("opacity",1e-6).remove(),E=d(y).style("opacity",1),S=p.selectAll("g").data(v,String),x=S.enter().insert("svg:g","path").style("opacity",1e-6),T=d(S.exit()).style("opacity",1e-6).remove(),N=d(S).style("opacity",1),C,k=tt(t.range()),L=p.selectAll(".domain").data([0]),A=L.enter().append("svg:path").attr("class","domain"),O=d(L),M=this.__chart__||t;this.__chart__=t.copy(),x.append("svg:line").attr("class","tick"),x.append("svg:text"),N.select("text").text(m);switch(n){case"bottom":C=un,E.attr("x2",0).attr("y2",i),N.select("line").attr("x2",0).attr("y2",r),N.select("text").attr("x",0).attr("y",Math.max(r,0)+o).attr("dy",".71em").attr("text-anchor","middle"),O.attr("d","M"+k[0]+","+s+"V0H"+k[1]+"V"+s);break;case"top":C=un,E.attr("x2",0).attr("y2",-i),N.select("line").attr("x2",0).attr("y2",-r),N.select("text").attr("x",0).attr("y",-(Math.max(r,0)+o)).attr("dy","0em").attr("text-anchor","middle"),O.attr("d","M"+k[0]+","+ -s+"V0H"+k[1]+"V"+ -s);break;case"left":C=an,E.attr("x2",-i).attr("y2",0),N.select("line").attr("x2",-r).attr("y2",0),N.select("text").attr("x",-(Math.max(r,0)+o)).attr("y",0).attr("dy",".32em").attr("text-anchor","end"),O.attr("d","M"+ -s+","+k[0]+"H0V"+k[1]+"H"+ -s);break;case"right":C=an,E.attr("x2",i).attr("y2",0),N.select("line").attr("x2",r).attr("y2",0),N.select("text").attr("x",Math.max(r,0)+o).attr("y",0).attr("dy",".32em").attr("text-anchor","start"),O.attr("d","M"+s+","+k[0]+"H0V"+k[1]+"H"+s)}x.call(C,M),N.call(C,t),T.call(C,t),b.call(C,M),E.call(C,t),w.call(C,t)})}var t=d3.scale.linear(),n="bottom",r=6,i=6,s=6,o=3,u=[10],a,f=0;return e.scale=function(n){return arguments.length?(t=n,e):t},e.orient=function(t){return arguments.length?(n=t,e):n},e.ticks=function(){return arguments.length?(u=arguments,e):u},e.tickFormat=function(t){return arguments.length?(a=t,e):a},e.tickSize=function(t,n,o){if(!arguments.length)return r;var u=arguments.length-1;return r=+t,i=u>1?+n:r,s=u>0?+arguments[u]:r,e},e.tickPadding=function(t){return arguments.length?(o=+t,e):o},e.tickSubdivide=function(t){return arguments.length?(f=+t,e):f},e},d3.svg.brush=function(){function e(n){var r=i&&s?["n","e","s","w","nw","ne","se","sw"]:i?["e","w"]:s?["n","s"]:[];n.each(function(){var n=d3.select(this).on("mousedown.brush",t),u=n.selectAll(".background").data([,]),a=n.selectAll(".extent").data([,]),f=n.selectAll(".resize").data(r,String),l;u.enter().append("svg:rect").attr("class","background").style("visibility","hidden").style("pointer-events","all").style("cursor","crosshair"),a.enter().append("svg:rect").attr("class","extent").style("cursor","move"),f.enter().append("svg:rect").attr("class",function(e){return"resize "+e}).attr("width",6).attr("height",6).style("visibility","hidden").style("pointer-events",e.empty()?"none":"all").style("cursor",function(e){return Br[e]}),f.exit().remove(),i&&(l=tt(i.range()),u.attr("x",l[0]).attr("width",l[1]-l[0]),ln(n,o)),s&&(l=tt(s.range()),u.attr("y",l[0]).attr("height",l[1]-l[0]),cn(n,o))})}function t(){var t=d3.select(d3.event.target);Cr=e,Lr=this,Mr=o,Hr=d3.svg.mouse(Lr),(_r=t.classed("extent"))?(Hr[0]=o[0][0]-Hr[0],Hr[1]=o[0][1]-Hr[1]):t.classed("resize")?(Dr=d3.event.target.__data__,Hr[0]=o[+/w$/.test(Dr)][0],Hr[1]=o[+/^n/.test(Dr)][1]):d3.event.altKey&&(Pr=Hr.slice()),Ar=!/^(n|s)$/.test(Dr)&&i,Or=!/^(e|w)$/.test(Dr)&&s,kr=n(this,arguments),kr("brushstart"),dn(),T()}function n(t,n){return function(i){var s=d3.event;try{d3.event={type:i,target:e},r[i].apply(t,n)}finally{d3.event=s}}}var r=d3.dispatch("brushstart","brush","brushend"),i,s,o=[[0,0],[0,0]];return e.x=function(t){return arguments.length?(i=t,e):i},e.y=function(t){return arguments.length?(s=t,e):s},e.extent=function(t){var n,r,u,a,f;return arguments.length?(i&&(n=t[0],r=t[1],s&&(n=n[0],r=r[0]),n=i(n),r=i(r),r<n&&(f=n,n=r,r=f),o[0][0]=n,o[1][0]=r),s&&(u=t[0],a=t[1],i&&(u=u[1],a=a[1]),u=s(u),a=s(a),a<u&&(f=u,u=a,a=f),o[0][1]=u,o[1][1]=a),e):(i&&(n=i.invert(o[0][0]),r=i.invert(o[1][0]),r<n&&(f=n,n=r,r=f)),s&&(u=s.invert(o[0][1]),a=s.invert(o[1][1]),a<u&&(f=u,u=a,a=f)),i&&s?[[n,u],[r,a]]:i?[n,r]:s&&[u,a])},e.clear=function(){return o[0][0]=o[0][1]=o[1][0]=o[1][1]=0,e},e.empty=function(){return i&&o[0][0]===o[1][0]||s&&o[0][1]===o[1][1]},e.on=function(t,n){return r.on(t,n),e},d3.select(window).on("mousemove.brush",dn).on("mouseup.brush",mn).on("keydown.brush",hn).on("keyup.brush",pn),e};var Cr,kr,Lr,Ar,Or,Mr,_r,Dr,Pr,Hr,Br={n:"ns-resize",e:"ew-resize",s:"ns-resize",w:"ew-resize",nw:"nwse-resize",ne:"nesw-resize",se:"nwse-resize",sw:"nesw-resize"};d3.behavior={},d3.behavior.drag=function(){function e(){this.on("mousedown.drag",n).on("touchstart.drag",n),d3.select(window).on("mousemove.drag",bn).on("touchmove.drag",bn).on("mouseup.drag",wn,!0).on("touchend.drag",wn,!0).on("click.drag",En,!0)}function t(){jr=r,Fr=d3.event.target,Rr=yn((Ir=this).parentNode),Ur=0,qr=arguments}function n(){t.apply(this,arguments),gn("dragstart")}var r=d3.dispatch("drag","dragstart","dragend");return e.on=function(t,n){return r.on(t,n),e},e};var jr,Fr,Ir,qr,Rr,Ur,zr;d3.behavior.zoom=function(){function e(){this.on("mousedown.zoom",n).on("mousewheel.zoom",r).on("DOMMouseScroll.zoom",r).on("dblclick.zoom",i).on("touchstart.zoom",s),d3.select(window).on("mousemove.zoom",Cn).on("mouseup.zoom",kn).on("touchmove.zoom",Nn).on("touchend.zoom",Tn).on("click.zoom",Ln,!0)}function t(){Kr=o,Qr=a,Gr=u.zoom,Yr=d3.event.target,Zr=this,ei=arguments}function n(){t.apply(this,arguments),Xr=Sn(d3.svg.mouse(Zr)),ti=!1,d3.event.preventDefault(),window.focus()}function r(){t.apply(this,arguments),Vr||(Vr=Sn(d3.svg.mouse(Zr))),An(xn()+o[2],d3.svg.mouse(Zr),Vr)}function i(){t.apply(this,arguments);var e=d3.svg.mouse(Zr);An(d3.event.shiftKey?Math.ceil(o[2]-1):Math.floor(o[2]+1),e,Sn(e))}function s(){t.apply(this,arguments);var e=Tn(),n,r=Date.now();e.length===1&&r-Jr<300&&An(1+Math.floor(o[2]),n=e[0],$r[n.identifier]),Jr=r}var o=[0,0,0],u=d3.dispatch("zoom"),a=ri;return e.extent=function(t){return arguments.length?(a=t==null?ri:t,e):a},e.on=function(t,n){return u
.on(t,n),e},e};var Wr,Xr,Vr,$r={},Jr=0,Kr,Qr,Gr,Yr,Zr,ei,ti,ni,ri=[[-Infinity,Infinity],[-Infinity,Infinity],[-Infinity,Infinity]]})();(function(){function e(e){var t=e.source,r=e.target,i=n(t,r),s=[t];while(t!==i)t=t.parent,s.push(t);var o=s.length;while(r!==i)s.splice(o,0,r),r=r.parent;return s}function t(e){var t=[],n=e.parent;while(n!=null)t.push(e),e=n,n=n.parent;return t.push(e),t}function n(e,n){if(e===n)return e;var r=t(e),i=t(n),s=r.pop(),o=i.pop(),u=null;while(s===o)u=s,s=r.pop(),o=i.pop();return u}function r(e){e.fixed|=2}function i(e){e!==Z&&(e.fixed&=1)}function s(){o(),Z.fixed&=1,Y=Z=null}function o(){Z.px+=d3.event.dx,Z.py+=d3.event.dy,Y.resume()}function u(e,t,n){var r=0,i=0;e.charge=0;if(!e.leaf){var s=e.nodes,o=s.length,a=-1,f;while(++a<o){f=s[a];if(f==null)continue;u(f,t,n),e.charge+=f.charge,r+=f.charge*f.cx,i+=f.charge*f.cy}}if(e.point){e.leaf||(e.point.x+=Math.random()-.5,e.point.y+=Math.random()-.5);var l=t*n[e.point.index];e.charge+=e.pointCharge=l,r+=l*e.point.x,i+=l*e.point.y}e.cx=r/e.charge,e.cy=i/e.charge}function a(e){return 20}function f(e){return 1}function l(e){return e.x}function c(e){return e.y}function h(e,t,n){e.y0=t,e.y=n}function p(e){var t=1,n=0,r=e[0][1],i,s=e.length;for(;t<s;++t)(i=e[t][1])>r&&(n=t,r=i);return n}function v(e){return e.reduce(m,0)}function m(e,t){return e+t[1]}function g(e,t){return y(e,Math.ceil(Math.log(t.length)/Math.LN2+1))}function y(e,t){var n=-1,r=+e[0],i=(e[1]-r)/t,s=[];while(++n<=t)s[n]=i*n+r;return s}function b(e){return[d3.min(e),d3.max(e)]}function w(e,t){return e.sort=d3.rebind(e,t.sort),e.children=d3.rebind(e,t.children),e.links=T,e.value=d3.rebind(e,t.value),e.nodes=function(t){return rt=!0,(e.nodes=e)(t)},e}function E(e){return e.children}function S(e){return e.value}function x(e,t){return t.value-e.value}function T(e){return d3.merge(e.map(function(e){return(e.children||[]).map(function(t){return{source:e,target:t}})}))}function N(e,t){return e.value-t.value}function C(e,t){var n=e._pack_next;e._pack_next=t,t._pack_prev=e,t._pack_next=n,n._pack_prev=t}function k(e,t){e._pack_next=t,t._pack_prev=e}function L(e,t){var n=t.x-e.x,r=t.y-e.y,i=e.r+t.r;return i*i-n*n-r*r>.001}function A(e){function t(e){n=Math.min(e.x-e.r,n),r=Math.max(e.x+e.r,r),i=Math.min(e.y-e.r,i),s=Math.max(e.y+e.r,s)}var n=Infinity,r=-Infinity,i=Infinity,s=-Infinity,o=e.length,u,a,f,l,c;e.forEach(O),u=e[0],u.x=-u.r,u.y=0,t(u);if(o>1){a=e[1],a.x=a.r,a.y=0,t(a);if(o>2){f=e[2],P(u,a,f),t(f),C(u,f),u._pack_prev=f,C(f,a),a=u._pack_next;for(var h=3;h<o;h++){P(u,a,f=e[h]);var p=0,d=1,v=1;for(l=a._pack_next;l!==a;l=l._pack_next,d++)if(L(l,f)){p=1;break}if(p==1)for(c=u._pack_prev;c!==l._pack_prev;c=c._pack_prev,v++)if(L(c,f)){v<d&&(p=-1,l=c);break}p==0?(C(u,f),a=f,t(f)):p>0?(k(u,l),a=l,h--):(k(l,a),u=l,h--)}}}var m=(n+r)/2,g=(i+s)/2,y=0;for(var h=0;h<o;h++){var b=e[h];b.x-=m,b.y-=g,y=Math.max(y,b.r+Math.sqrt(b.x*b.x+b.y*b.y))}return e.forEach(M),y}function O(e){e._pack_next=e._pack_prev=e}function M(e){delete e._pack_next,delete e._pack_prev}function _(e){var t=e.children;t&&t.length?(t.forEach(_),e.r=A(t)):e.r=Math.sqrt(e.value)}function D(e,t,n,r){var i=e.children;e.x=t+=r*e.x,e.y=n+=r*e.y,e.r*=r;if(i){var s=-1,o=i.length;while(++s<o)D(i[s],t,n,r)}}function P(e,t,n){var r=e.r+n.r,i=t.x-e.x,s=t.y-e.y;if(r&&(i||s)){var o=t.r+n.r,u=Math.sqrt(i*i+s*s),a=Math.max(-1,Math.min(1,(r*r+u*u-o*o)/(2*r*u))),f=Math.acos(a),l=a*(r/=u),c=Math.sin(f)*r;n.x=e.x+l*i+c*s,n.y=e.y+l*s-c*i}else n.x=e.x+r,n.y=e.y}function H(e){return 1+d3.max(e,function(e){return e.y})}function B(e){return e.reduce(function(e,t){return e+t.x},0)/e.length}function j(e){var t=e.children;return t&&t.length?j(t[0]):e}function F(e){var t=e.children,n;return t&&(n=t.length)?F(t[n-1]):e}function I(e,t){return e.parent==t.parent?1:2}function q(e){var t=e.children;return t&&t.length?t[0]:e._tree.thread}function R(e){var t=e.children,n;return t&&(n=t.length)?t[n-1]:e._tree.thread}function U(e,t){var n=e.children;if(n&&(i=n.length)){var r,i,s=-1;while(++s<i)t(r=U(n[s],t),e)>0&&(e=r)}return e}function z(e,t){return e.x-t.x}function W(e,t){return t.x-e.x}function X(e,t){return e.depth-t.depth}function V(e,t){function n(e,r){var i=e.children;if(i&&(a=i.length)){var s,o=null,u=-1,a;while(++u<a)s=i[u],n(s,o),o=s}t(e,r)}n(e,null)}function $(e){var t=0,n=0,r=e.children,i=r.length,s;while(--i>=0)s=r[i]._tree,s.prelim+=t,s.mod+=t,t+=s.shift+(n+=s.change)}function J(e,t,n){e=e._tree,t=t._tree;var r=n/(t.number-e.number);e.change+=r,t.change-=r,t.shift+=n,t.prelim+=n,t.mod+=n}function K(e,t,n){return e._tree.ancestor.parent==t.parent?e._tree.ancestor:n}function Q(e){return{x:e.x,y:e.y,dx:e.dx,dy:e.dy}}function G(e,t){var n=e.x+t[3],r=e.y+t[0],i=e.dx-t[1]-t[3],s=e.dy-t[0]-t[2];return i<0&&(n+=i/2,i=0),s<0&&(r+=s/2,s=0),{x:n,y:r,dx:i,dy:s}}d3.layout={},d3.layout.bundle=function(){return function(t){var n=[],r=-1,i=t.length;while(++r<i)n.push(e(t[r]));return n}},d3.layout.chord=function(){function e(){var e={},n=[],c=d3.range(o),h=[],p,v,m,g,y;r=[],i=[],p=0,g=-1;while(++g<o){v=0,y=-1;while(++y<o)v+=s[g][y];n.push(v),h.push(d3.range(o)),p+=v}a&&c.sort(function(e,t){return a(n[e],n[t])}),f&&h.forEach(function(e,t){e.sort(function(e,n){return f(s[t][e],s[t][n])})}),p=(2*Math.PI-u*o)/p,v=0,g=-1;while(++g<o){m=v,y=-1;while(++y<o){var b=c[g],w=h[b][y],E=s[b][w],S=v,x=v+=E*p;e[b+"-"+w]={index:b,subindex:w,startAngle:S,endAngle:x,value:E}}i.push({index:b,startAngle:m,endAngle:v,value:(v-m)/p}),v+=u}g=-1;while(++g<o){y=g-1;while(++y<o){var T=e[g+"-"+y],N=e[y+"-"+g];(T.value||N.value)&&r.push(T.value<N.value?{source:N,target:T}:{source:T,target:N})}}l&&t()}function t(){r.sort(function(e,t){return l((e.source.value+e.target.value)/2,(t.source.value+t.target.value)/2)})}var n={},r,i,s,o,u=0,a,f,l;return n.matrix=function(e){return arguments.length?(o=(s=e)&&s.length,r=i=null,n):s},n.padding=function(e){return arguments.length?(u=e,r=i=null,n):u},n.sortGroups=function(e){return arguments.length?(a=e,r=i=null,n):a},n.sortSubgroups=function(e){return arguments.length?(f=e,r=null,n):f},n.sortChords=function(e){return arguments.length?(l=e,r&&t(),n):l},n.chords=function(){return r||e(),r},n.groups=function(){return i||e(),i},n},d3.layout.force=function(){function e(e){return function(t,n,r,i,s){if(t.point!==e){var o=t.cx-e.x,u=t.cy-e.y,a=1/Math.sqrt(o*o+u*u);if((i-n)*a<w){var f=t.charge*a*a;return e.px-=o*f,e.py-=u*f,!0}if(t.point&&isFinite(a)){var f=t.pointCharge*a*a;e.px-=o*f,e.py-=u*f}}return!t.charge}}function t(){var t=S.length,n=x.length,r,i,s,o,a,f,l,p,m;for(i=0;i<n;++i){s=x[i],o=s.source,a=s.target,p=a.x-o.x,m=a.y-o.y;if(f=p*p+m*m)f=d*N[i]*((f=Math.sqrt(f))-T[i])/f,p*=f,m*=f,a.x-=p*(l=o.weight/(a.weight+o.weight)),a.y-=m*l,o.x+=p*(l=1-l),o.y+=m*l}if(l=d*b){p=h[0]/2,m=h[1]/2,i=-1;if(l)while(++i<t)s=S[i],s.x+=(p-s.x)*l,s.y+=(m-s.y)*l}if(y){u(r=d3.geom.quadtree(S),d,C),i=-1;while(++i<t)(s=S[i]).fixed||r.visit(e(s))}i=-1;while(++i<t)s=S[i],s.fixed?(s.x=s.px,s.y=s.py):(s.x-=(s.px-(s.px=s.x))*v,s.y-=(s.py-(s.py=s.y))*v);return c.tick({type:"tick",alpha:d}),(d*=.99)<.005}function n(e){r(Z=e),Y=l}var l={},c=d3.dispatch("tick"),h=[1,1],p,d,v=.9,m=a,g=f,y=-30,b=.1,w=.8,E,S=[],x=[],T,N,C;return l.on=function(e,t){return c.on(e,t),l},l.nodes=function(e){return arguments.length?(S=e,l):S},l.links=function(e){return arguments.length?(x=e,l):x},l.size=function(e){return arguments.length?(h=e,l):h},l.linkDistance=function(e){return arguments.length?(m=d3.functor(e),l):m},l.distance=l.linkDistance,l.linkStrength=function(e){return arguments.length?(g=d3.functor(e),l):g},l.friction=function(e){return arguments.length?(v=e,l):v},l.charge=function(e){return arguments.length?(y=typeof e=="function"?e:+e,l):y},l.gravity=function(e){return arguments.length?(b=e,l):b},l.theta=function(e){return arguments.length?(w=e,l):w},l.start=function(){function e(e,r){var i=t(n),s=-1,o=i.length,u;while(++s<o)if(!isNaN(u=i[s][e]))return u;return Math.random()*r}function t(){if(!a){a=[];for(r=0;r<i;++r)a[r]=[];for(r=0;r<s;++r){var e=x[r];a[e.source.index].push(e.target),a[e.target.index].push(e.source)}}return a[n]}var n,r,i=S.length,s=x.length,o=h[0],u=h[1],a,f;for(n=0;n<i;++n)(f=S[n]).index=n,f.weight=0;T=[],N=[];for(n=0;n<s;++n)f=x[n],typeof f.source=="number"&&(f.source=S[f.source]),typeof f.target=="number"&&(f.target=S[f.target]),T[n]=m.call(this,f,n),N[n]=g.call(this,f,n),++f.source.weight,++f.target.weight;for(n=0;n<i;++n)f=S[n],isNaN(f.x)&&(f.x=e("x",o)),isNaN(f.y)&&(f.y=e("y",u)),isNaN(f.px)&&(f.px=f.x),isNaN(f.py)&&(f.py=f.y);C=[];if(typeof y=="function")for(n=0;n<i;++n)C[n]=+y.call(this,S[n],n);else for(n=0;n<i;++n)C[n]=y;return l.resume()},l.resume=function(){return d=.1,d3.timer(t),l},l.stop=function(){return d=0,l},l.drag=function(){p||(p=d3.behavior.drag().on("dragstart",n).on("drag",o).on("dragend",s)),this.on("mouseover.force",r).on("mouseout.force",i).call(p)},l};var Y,Z;d3.layout.partition=function(){function e(t,n,r,i){var s=t.children;t.x=n,t.y=t.depth*i,t.dx=r,t.dy=i;if(s&&(u=s.length)){var o=-1,u,a,f;r=t.value?r/t.value:0;while(++o<u)e(a=s[o],n,f=a.value*r,i),n+=f}}function t(e){var n=e.children,r=0;if(n&&(s=n.length)){var i=-1,s;while(++i<s)r=Math.max(r,t(n[i]))}return 1+r}function n(n,s){var o=r.call(this,n,s);return e(o[0],0,i[0],i[1]/t(o[0])),o}var r=d3.layout.hierarchy(),i=[1,1];return n.size=function(e){return arguments.length?(i=e,n):i},w(n,r)},d3.layout.pie=function(){function e(s,o){var u=s.map(function(n,r){return+t.call(e,n,r)}),a=+(typeof r=="function"?r.apply(this,arguments):r),f=((typeof i=="function"?i.apply(this,arguments):i)-r)/d3.sum(u),l=d3.range(s.length);n!=null&&l.sort(n===et?function(e,t){return u[t]-u[e]}:function(e,t){return n(s[e],s[t])});var c=l.map(function(e){return{data:s[e],value:d=u[e],startAngle:a,endAngle:a+=d*f}});return s.map(function(e,t){return c[l[t]]})}var t=Number,n=et,r=0,i=2*Math.PI;return e.value=function(n){return arguments.length?(t=n,e):t},e.sort=function(t){return arguments.length?(n=t,e):n},e.startAngle=function(t){return arguments.length?(r=t,e):r},e.endAngle=function(t){return arguments.length?(i=t,e):i},e};var et={};d3.layout.stack=function(){function e(u,a){var f=u.map(function(n,r){return t.call(e,n,r)}),l=f.map(function(t,n){return t.map(function(t,n){return[s.call(e,t,n),o.call(e,t,n)]})}),c=n.call(e,l,a);f=d3.permute(f,c),l=d3.permute(l,c);var h=r.call(e,l,a),p=f.length,v=f[0].length,m,g,y;for(g=0;g<v;++g){i.call(e,f[0][g],y=h[g],l[0][g][1]);for(m=1;m<p;++m)i.call(e,f[m][g],y+=l[m-1][g][1],l[m][g][1])}return u}var t=Object,n=tt["default"],r=nt.zero,i=h,s=l,o=c;return e.values=function(n){return arguments.length?(t=n,e):t},e.order=function(t){return arguments.length?(n=typeof t=="function"?t:tt[t],e):n},e.offset=function(t){return arguments.length?(r=typeof t=="function"?t:nt[t],e):r},e.x=function(t){return arguments.length?(s=t,e):s},e.y=function(t){return arguments.length?(o=t,e):o},e.out=function(t){return arguments.length?(i=t,e):i},e};var tt={"inside-out":function(e){var t=e.length,n,r,i=e.map(p),s=e.map(v),o=d3.range(t).sort(function(e,t){return i[e]-i[t]}),u=0,a=0,f=[],l=[];for(n=0;n<t;++n)r=o[n],u<a?(u+=s[r],f.push(r)):(a+=s[r],l.push(r));return l.reverse().concat(f)},reverse:function(e){return d3.range(e.length).reverse()},"default":function(e){return d3.range(e.length)}},nt={silhouette:function(e){var t=e.length,n=e[0].length,r=[],i=0,s,o,u,a=[];for(o=0;o<n;++o){for(s=0,u=0;s<t;s++)u+=e[s][o][1];u>i&&(i=u),r.push(u)}for(o=0;o<n;++o)a[o]=(i-r[o])/2;return a},wiggle:function(e){var t=e.length,n=e[0],r=n.length,i=0,s,o,u,a,f,l,c,h,p,d=[];d[0]=h=p=0;for(o=1;o<r;++o){for(s=0,a=0;s<t;++s)a+=e[s][o][1];for(s=0,f=0,c=n[o][0]-n[o-1][0];s<t;++s){for(u=0,l=(e[s][o][1]-e[s][o-1][1])/(2*c);u<s;++u)l+=(e[u][o][1]-e[u][o-1][1])/c;f+=l*e[s][o][1]}d[o]=h-=a?f/a*c:0,h<p&&(p=h)}for(o=0;o<r;++o)d[o]-=p;return d},expand:function(e){var t=e.length,n=e[0].length,r=1/t,i,s,o,u=[];for(s=0;s<n;++s){for(i=0,o=0;i<t;i++)o+=e[i][s][1];if(o)for(i=0;i<t;i++)e[i][s][1]/=o;else for(i=0;i<t;i++)e[i][s][1]=r}for(s=0;s<n;++s)u[s]=0;return u},zero:function(e){var t=-1,n=e[0].length,r=[];while(++t<n)r[t]=0;return r}};d3.layout.histogram=function(){function e(e,s){var o=[],u=e.map(n,this),a=r.call(this,u,s),f=i.call(this,a,u,s),l,s=-1,c=u.length,h=f.length-1,p=t?1:1/c,v;while(++s<h)l=o[s]=[],l.dx=f[s+1]-(l.x=f[s]),l.y=0;s=-1;while(++s<c)v=u[s],v>=a[0]&&v<=a[1]&&(l=o[d3.bisect(f,v,1,h)-1],l.y+=p,l.push(e[s]));return o}var t=!0,n=Number,r=b,i=g;return e.value=function(t){return arguments.length?(n=t,e):n},e.range=function(t){return arguments.length?(r=d3.functor(t),e):r},e.bins=function(t){return arguments.length?(i=typeof t=="number"?function(e){return y(e,t)}:d3.functor(t),e):i},e.frequency=function(n){return arguments.length?(t=!!n,e):t},e},d3.layout.hierarchy=function(){function e(t,o,u){var a=i.call(n,t,o),f=rt?t:{data:t};f.depth=o,u.push(f);if(a&&(c=a.length)){var l=-1,c,h=f.children=[],p=0,v=o+1;while(++l<c)d=e(a[l],v,u),d.parent=f,h.push(d),p+=d.value;r&&h.sort(r),s&&(f.value=p)}else s&&(f.value=+s.call(n,t,o)||0);return f}function t(e,r){var i=e.children,o=0;if(i&&(a=i.length)){var u=-1,a,f=r+1;while(++u<a)o+=t(i[u],f)}else s&&(o=+s.call(n,rt?e:e.data,r)||0);return s&&(e.value=o),o}function n(t){var n=[];return e(t,0,n),n}var r=x,i=E,s=S;return n.sort=function(e){return arguments.length?(r=e,n):r},n.children=function(e){return arguments.length?(i=e,n):i},n.value=function(e){return arguments.length?(s=e,n):s},n.revalue=function(e){return t(e,0),e},n};var rt=!1;d3.layout.pack=function(){function e(e,r){var i=t.call(this,e,r),s=i[0];s.x=0,s.y=0,_(s);var o=n[0],u=n[1],a=1/Math.max(2*s.r/o,2*s.r/u);return D(s,o/2,u/2,a),i}var t=d3.layout.hierarchy().sort(N),n=[1,1];return e.size=function(t){return arguments.length?(n=t,e):n},w(e,t)},d3.layout.cluster=function(){function e(e,i){var s=t.call(this,e,i),o=s[0],u,a=0,f,l;V(o,function(e){var t=e.children;t&&t.length?(e.x=B(t),e.y=H(t)):(e.x=u?a+=n(e,u):0,e.y=0,u=e)});var c=j(o),h=F(o),p=c.x-n(c,h)/2,d=h.x+n(h,c)/2;return V(o,function(e){e.x=(e.x-p)/(d-p)*r[0],e.y=(1-e.y/o.y)*r[1]}),s}var t=d3.layout.hierarchy().sort(null).value(null),n=I,r=[1,1];return e.separation=function(t){return arguments.length?(n=t,e):n},e.size=function(t){return arguments.length?(r=t,e):r},w(e,t)},d3.layout.tree=function(){function e(e,i){function s(e,t){var r=e.children,i=e._tree;if(r&&(o=r.length)){var o,a=r[0],f,l=a,c,h=-1;while(++h<o)c=r[h],s(c,f),l=u(c,f,l),f=c;$(e);var p=.5*(a._tree.prelim+c._tree.prelim);t?(i.prelim=t._tree.prelim+n(e,t),i.mod=i.prelim-p):i.prelim=p}else t&&(i.prelim=t._tree.prelim+n(e,t))}function o(e,t){e.x=e._tree.prelim+t;var n=e.children;if(n&&(i=n.length)){var r=-1,i;t+=e._tree.mod;while(++r<i)o(n[r],t)}}function u(e,t,r){if(t){var i=e,s=e,o=t,u=e.parent.children[0],a=i._tree.mod,f=s._tree.mod,l=o._tree.mod,c=u._tree.mod,h;while(o=R(o),i=q(i),o&&i)u=q(u),s=R(s),s._tree.ancestor=e,h=o._tree.prelim+l-i._tree.prelim-a+n(o,i),h>0&&(J(K(o,e,r),e,h),a+=h,f+=h),l+=o._tree.mod,a+=i._tree.mod,c+=u._tree.mod,f+=s._tree.mod;o&&!R(s)&&(s._tree.thread=o,s._tree.mod+=l-f),i&&!q(u)&&(u._tree.thread=i,u._tree.mod+=a-c,r=e)}return r}var a=t.call(this,e,i),f=a[0];V(f,function(e,t){e._tree={ancestor:e,prelim:0,mod:0,change:0,shift:0,number:t?t._tree.number+1:0}}),s(f),o(f,-f._tree.prelim);var l=U(f,W),c=U(f,z),h=U(f,X),p=l.x-n(l,c)/2,d=c.x+n(c,l)/2,v=h.depth||1;return V(f,function(e){e.x=(e.x-p)/(d-p)*r[0],e.y=e.depth/v*r[1],delete e._tree}),a}var t=d3.layout.hierarchy().sort(null).value(null),n=I,r=[1,1];return e.separation=function(t){return arguments.length?(n=t,e):n},e.size=function(t){return arguments.length?(r=t,e):r},w(e,t)},d3.layout.treemap=function(){function e(e,t){var n=-1,r=e.length,i,s;while(++n<r)s=(i=e[n]).value*(t<0?0:t),i.area=isNaN(s)||s<=0?0:s}function t(n){var s=n.children;if(s&&s.length){var o=l(n),u=[],a=s.slice(),f,c=Infinity,h,p=Math.min(o.dx,o.dy),d;e(a,o.dx*o.dy/n.value),u.area=0;while((d=a.length)>0)u.push(f=a[d-1]),u.area+=f.area,(h=r(u,p))<=c?(a.pop(),c=h):(u.area-=u.pop().area,i(u,p,o,!1),p=Math.min(o.dx,o.dy),u.length=u.area=0,c=Infinity);u.length&&(i(u,p,o,!0),u.length=u.area=0),s.forEach(t)}}function n(t){var r=t.children;if(r&&r.length){var s=l(t),o=r.slice(),u,a=[];e(o,s.dx*s.dy/t.value),a.area=0;while(u=o.pop())a.push(u),a.area+=u.area,u.z!=null&&(i(a,u.z?s.dx:s.dy,s,!o.length),a.length=a.area=0);r.forEach(n)}}function r(e,t){var n=e.area,r,i=0,s=Infinity,o=-1,u=e.length;while(++o<u){if(!(r=e[o].area))continue;r<s&&(s=r),r>i&&(i=r)}return n*=n,t*=t,n?Math.max(t*i*p/n,n/(t*s*p)):Infinity}function i(e,t,n,r){var i=-1,s=e.length,o=n.x,a=n.y,f=t?u(e.area/t):0,l;if(t==n.dx){if(r||f>n.dy)f=f?n.dy:0;while(++i<s)l=e[i],l.x=o,l.y=a,l.dy=f,o+=l.dx=f?u(l.area/f):0;l.z=!0,l.dx+=n.x+n.dx-o,n.y+=f,n.dy-=f}else{if(r||f>n.dx)f=f?n.dx:0;while(++i<s)l=e[i],l.x=o,l.y=a,l.dx=f,a+=l.dy=f?u(l.area/f):0;l.z=!1,l.dy+=n.y+n.dy-a,n.x+=f,n.dx-=f}}function s(r){var i=h||o(r),s=i[0];return s.x=0,s.y=0,s.dx=a[0],s.dy=a[1],h&&o.revalue(s),e([s],s.dx*s.dy/s.value),(h?n:t)(s),c&&(h=i),i}var o=d3.layout.hierarchy(),u=Math.round,a=[1,1],f=null,l=Q,c=!1,h,p=.5*(1+Math.sqrt(5));return s.size=function(e){return arguments.length?(a=e,s):a},s.padding=function(e){function t(t){var n=e.call(s,t,t.depth);return n==null?Q(t):G(t,typeof n=="number"?[n,n,n,n]:n)}function n(t){return G(t,e)}if(!arguments.length)return f;var r;return l=(f=e)==null?Q:(r=typeof e)==="function"?t:r==="number"?(e=[e,e,e,e],n):n,s},s.round=function(e){return arguments.length?(u=e?Math.round:Number,s):u!=Number},s.sticky=function(e){return arguments.length?(c=e,h=null,s):c},s.ratio=function(e){return arguments.length?(p=e,s):p},w(s,o)}})();var Rickshaw={namespace:function(e,t){var n=e.split("."),r=Rickshaw;for(var i=1,s=n.length;i<s;i++){var o=n[i];r[o]=r[o]||{};r=r[o]}return r},keys:function(e){var t=[];for(var n in e)t.push(n);return t},extend:function(e,t){for(var n in t)e[n]=t[n];return e}};if(typeof module!="undefined"&&module.exports){var d3=require("d3");module.exports=Rickshaw}(function(e){function f(e){return t.call(e)===a}function l(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);return e}function c(e){if(h(e)!==u)throw new TypeError;var t=[];for(var n in e)e.hasOwnProperty(n)&&t.push(n);return t}function h(e){switch(e){case null:return n;case void 0:return r}var t=typeof e;switch(t){case"boolean":return i;case"number":return s;case"string":return o}return u}function p(e){return typeof e=="undefined"}function v(e){var t=e.toString().match(/^[\s\(]*function[^(]*\(([^)]*)\)/)[1].replace(/\/\/.*?[\r\n]|\/\*(?:.|[\r\n])*?\*\//g,"").replace(/\s+/g,"").split(",");return t.length==1&&!t[0]?[]:t}function m(e,t){var n=e;return function(){var e=g([b(n,this)],arguments);return t.apply(this,e)}}function g(e,t){var n=e.length,r=t.length;while(r--)e[n+r]=t[r];return e}function y(e,t){e=d.call(e,0);return g(e,t)}function b(e,t){if(arguments.length<2&&p(arguments[0]))return this;var n=e,r=d.call(arguments,2);return function(){var e=y(r,arguments);return n.apply(t,e)}}var t=Object.prototype.toString,n="Null",r="Undefined",i="Boolean",s="Number",o="String",u="Object",a="[object Function]",d=Array.prototype.slice,w=function(){},E=function(){function t(){}function n(){function r(){this.initialize.apply(this,arguments)}var e=null,n=[].slice.apply(arguments);f(n[0])&&(e=n.shift());l(r,E.Methods);r.superclass=e;r.subclasses=[];if(e){t.prototype=e.prototype;r.prototype=new t;try{e.subclasses.push(r)}catch(i){}}for(var s=0,o=n.length;s<o;s++)r.addMethods(n[s]);r.prototype.initialize||(r.prototype.initialize=w);r.prototype.constructor=r;return r}function r(t){var n=this.superclass&&this.superclass.prototype,r=c(t);if(e){t.toString!=Object.prototype.toString&&r.push("toString");t.valueOf!=Object.prototype.valueOf&&r.push("valueOf")}for(var i=0,s=r.length;i<s;i++){var o=r[i],u=t[o];if(n&&f(u)&&v(u)[0]=="$super"){var a=u;u=m(function(e){return function(){return n[e].apply(this,arguments)}}(o),a);u.valueOf=b(a.valueOf,a);u.toString=b(a.toString,a)}this.prototype[o]=u}return this}var e=function(){for(var e in{toString:1})if(e==="toString")return!1;return!0}();return{create:n,Methods:{addMethods:r}}}();e.exports?e.exports.Class=E:e.Class=E})(Rickshaw);Rickshaw.namespace("Rickshaw.Compat.ClassList");Rickshaw.Compat.ClassList=function(){typeof document!="undefined"&&!("classList"in document.createElement("a"))&&function(e){"use strict";var t="classList",n="prototype",r=(e.HTMLElement||e.Element)[n],i=Object,s=String[n].trim||function(){return this.replace(/^\s+|\s+$/g,"")},o=Array[n].indexOf||function(e){var t=0,n=this.length;for(;t<n;t++)if(t in this&&this[t]===e)return t;return-1},u=function(e,t){this.name=e;this.code=DOMException[e];this.message=t},a=function(e,t){if(t==="")throw new u("SYNTAX_ERR","An invalid or illegal string was specified");if(/\s/.test(t))throw new u("INVALID_CHARACTER_ERR","String contains an invalid character");return o.call(e,t)},f=function(e){var t=s.call(e.className),n=t?t.split(/\s+/):[],r=0,i=n.length;for(;r<i;r++)this.push(n[r]);this._updateClassName=function(){e.className=this.toString()}},l=f[n]=[],c=function(){return new f(this)};u[n]=Error[n];l.item=function(e){return this[e]||null};l.contains=function(e){e+="";return a(this,e)!==-1};l.add=function(e){e+="";if(a(this,e)===-1){this.push(e);this._updateClassName()}};l.remove=function(e){e+="";var t=a(this,e);if(t!==-1){this.splice(t,1);this._updateClassName()}};l.toggle=function(e){e+="";a(this,e)===-1?this.add(e):this.remove(e)};l.toString=function(){return this.join(" ")};if(i.defineProperty){var h={get:c,enumerable:!0,configurable:!0};try{i.defineProperty(r,t,h)}catch(p){if(p.number===-2146823252){h.enumerable=!1;i.defineProperty(r,t,h)}}}else i[n].__defineGetter__&&r.__defineGetter__(t,c)}(window)};(typeof RICKSHAW_NO_COMPAT!="undefined"&&!RICKSHAW_NO_COMPAT||typeof RICKSHAW_NO_COMPAT=="undefined")&&new Rickshaw.Compat.ClassList;Rickshaw.namespace("Rickshaw.Graph");Rickshaw.Graph=function(e){if(!e.element)throw"Rickshaw.Graph needs a reference to an element";this.element=e.element;this.series=e.series;this.defaults={interpolation:"cardinal",offset:"zero",min:undefined,max:undefined};Rickshaw.keys(this.defaults).forEach(function(t){this[t]=e[t]||this.defaults[t]},this);this.window={};this.updateCallbacks=[];var t=this;this.initialize=function(e){this.validateSeries(e.series);this.series.active=function(){return t.series.filter(function(e){return!e.disabled})};this.setSize({width:e.width,height:e.height});this.element.classList.add("rickshaw_graph");this.vis=d3.select(this.element).append("svg:svg").attr("width",this.width).attr("height",this.height);var n=[Rickshaw.Graph.Renderer.Stack,Rickshaw.Graph.Renderer.Line,Rickshaw.Graph.Renderer.Bar,Rickshaw.Graph.Renderer.Area,Rickshaw.Graph.Renderer.ScatterPlot];n.forEach(function(e){if(!e)return;t.registerRenderer(new e({graph:t}))});this.setRenderer(e.renderer||"stack",e);this.discoverRange()};this.validateSeries=function(e){if(!(e instanceof Array||e instanceof Rickshaw.Series)){var t=Object.prototype.toString.apply(e);throw"series is not an array: "+t}var n;e.forEach(function(e){if(!(e instanceof Object))throw"series element is not an object: "+e;if(!e.data)throw"series has no data: "+JSON.stringify(e);if(!(e.data instanceof Array))throw"series data is not an array: "+JSON.stringify(e.data);var t=e.data[0].x,n=e.data[0].y;if(typeof t!="number"||typeof n!="number"&&n!==null)throw"x and y properties of points should be numbers instead of "+typeof t+" and "+typeof n},this)};this.dataDomain=function(){var e=this.series[0].data;return[e[0].x,e.slice(-1).shift().x]};this.discoverRange=function(){var e=this.renderer.domain();this.x=d3.scale.linear().domain(e.x).range([0,this.width]);this.y=d3.scale.linear().domain(e.y).range([this.height,0]);this.y.magnitude=d3.scale.linear().domain([e.y[0]-e.y[0],e.y[1]-e.y[0]]).range([0,this.height])};this.render=function(){var e=this.stackData();this.discoverRange();this.renderer.render();this.updateCallbacks.forEach(function(e){e()})};this.update=this.render;this.stackData=function(){var e=this.series.active().map(function(e){return e.data}).map(function(e){return e.filter(function(e){return this._slice(e)},this)},this);this.stackData.hooks.data.forEach(function(n){e=n.f.apply(t,[e])});var n;if(!this.renderer.unstack){this._validateStackable();var r=d3.layout.stack();r.offset(t.offset);n=r(e)}n=n||e;this.stackData.hooks.after.forEach(function(r){n=r.f.apply(t,[e])});var i=0;this.series.forEach(function(e){if(e.disabled)return;e.stack=n[i++]});this.stackedData=n;return n};this._validateStackable=function(){var e=this.series,t;e.forEach(function(e){t=t||e.data.length;if(t&&e.data.length!=t)throw"stacked series cannot have differing numbers of points: "+t+" vs "+e.data.length+"; see Rickshaw.Series.fill()"},this)};this.stackData.hooks={data:[],after:[]};this._slice=function(e){if(this.window.xMin||this.window.xMax){var t=!0;this.window.xMin&&e.x<this.window.xMin&&(t=!1);this.window.xMax&&e.x>this.window.xMax&&(t=!1);return t}return!0};this.onUpdate=function(e){this.updateCallbacks.push(e)};this.registerRenderer=function(e){this._renderers=this._renderers||{};this._renderers[e.name]=e};this.configure=function(e){(e.width||e.height)&&this.setSize(e);Rickshaw.keys(this.defaults).forEach(function(t){this[t]=t in e?e[t]:t in this?this[t]:this.defaults[t]},this);this.setRenderer(e.renderer||this.renderer.name,e)};this.setRenderer=function(e,t){if(!this._renderers[e])throw"couldn't find renderer "+e;this.renderer=this._renderers[e];typeof t=="object"&&this.renderer.configure(t)};this.setSize=function(e){e=e||{};if(typeof window!==undefined)var t=window.getComputedStyle(this.element,null),n=parseInt(t.getPropertyValue("width")),r=parseInt(t.getPropertyValue("height"));this.width=e.width||n||400;this.height=e.height||r||250;this.vis&&this.vis.attr("width",this.width).attr("height",this.height)};this.initialize(e)};Rickshaw.namespace("Rickshaw.Fixtures.Color");Rickshaw.Fixtures.Color=function(){this.schemes={};this.schemes.spectrum14=["#ecb796","#dc8f70","#b2a470","#92875a","#716c49","#d2ed82","#bbe468","#a1d05d","#e7cbe6","#d8aad6","#a888c2","#9dc2d3","#649eb9","#387aa3"].reverse();this.schemes.spectrum2000=["#57306f","#514c76","#646583","#738394","#6b9c7d","#84b665","#a7ca50","#bfe746","#e2f528","#fff726","#ecdd00","#d4b11d","#de8800","#de4800","#c91515","#9a0000","#7b0429","#580839","#31082b"];this.schemes.spectrum2001=["#2f243f","#3c2c55","#4a3768","#565270","#6b6b7c","#72957f","#86ad6e","#a1bc5e","#b8d954","#d3e04e","#ccad2a","#cc8412","#c1521d","#ad3821","#8a1010","#681717","#531e1e","#3d1818","#320a1b"];this.schemes.classic9=["#423d4f","#4a6860","#848f39","#a2b73c","#ddcb53","#c5a32f","#7d5836","#963b20","#7c2626","#491d37","#2f254a"].reverse();this.schemes.httpStatus={503:"#ea5029",502:"#d23f14",500:"#bf3613",410:"#efacea",409:"#e291dc",403:"#f457e8",408:"#e121d2",401:"#b92dae",405:"#f47ceb",404:"#a82a9f",400:"#b263c6",301:"#6fa024",302:"#87c32b",307:"#a0d84c",304:"#28b55c",200:"#1a4f74",206:"#27839f",201:"#52adc9",202:"#7c979f",203:"#a5b8bd",204:"#c1cdd1"};this.schemes.colorwheel=["#b5b6a9","#858772","#785f43","#96557e","#4682b4","#65b9ac","#73c03a","#cb513a"].reverse();this.schemes.cool=["#5e9d2f","#73c03a","#4682b4","#7bc3b8","#a9884e","#c1b266","#a47493","#c09fb5"];this.schemes.munin=["#00cc00","#0066b3","#ff8000","#ffcc00","#330099","#990099","#ccff00","#ff0000","#808080","#008f00","#00487d","#b35a00","#b38f00","#6b006b","#8fb300","#b30000","#bebebe","#80ff80","#80c9ff","#ffc080","#ffe680","#aa80ff","#ee00cc","#ff8080","#666600","#ffbfff","#00ffcc","#cc6699","#999900"]};Rickshaw.namespace("Rickshaw.Fixtures.RandomData");Rickshaw.Fixtures.RandomData=function(e){var t;e=e||1;var n=200,r=Math.floor((new Date).getTime()/1e3);this.addData=function(t){var i=Math.random()*100+15+n,s=t[0].length,o=1;t.forEach(function(t){var n=Math.random()*20,u=i/25+o++ +(Math.cos(s*o*11/960)+2)*15+(Math.cos(s/7)+2)*7+(Math.cos(s/17)+2)*1;t.push({x:s*e+r,y:u+n})});n=i*.85}};Rickshaw.namespace("Rickshaw.Fixtures.Time");Rickshaw.Fixtures.Time=function(){var e=(new Date).getTimezoneOffset()*60,t=this;this.months=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];this.units=[{name:"decade",seconds:315576e3,formatter:function(e){return parseInt(e.getUTCFullYear()/10)*10}},{name:"year",seconds:31557600,formatter:function(e){return e.getUTCFullYear()}},{name:"month",seconds:2635200,formatter:function(e){return t.months[e.getUTCMonth()]}},{name:"week",seconds:604800,formatter:function(e){return t.formatDate(e)}},{name:"day",seconds:86400,formatter:function(e){return e.getUTCDate()}},{name:"6 hour",seconds:21600,formatter:function(e){return t.formatTime(e)}},{name:"hour",seconds:3600,formatter:function(e){return t.formatTime(e)}},{name:"15 minute",seconds:900,formatter:function(e){return t.formatTime(e)}},{name:"minute",seconds:60,formatter:function(e){return e.getUTCMinutes()}},{name:"15 second",seconds:15,formatter:function(e){return e.getUTCSeconds()+"s"}},{name:"second",seconds:1,formatter:function(e){return e.getUTCSeconds()+"s"}}];this.unit=function(e){return this.units.filter(function(t){return e==t.name}).shift()};this.formatDate=function(e){return e.toUTCString().match(/, (\w+ \w+ \w+)/)[1]};this.formatTime=function(e){return e.toUTCString().match(/(\d+:\d+):/)[1]};this.ceil=function(e,t){if(t.name=="month"){var n=new Date((e+t.seconds-1)*1e3),r=new Date(0);r.setUTCFullYear(n.getUTCFullYear());r.setUTCMonth(n.getUTCMonth());r.setUTCDate(1);r.setUTCHours(0);r.setUTCMinutes(0);r.setUTCSeconds(0);r.setUTCMilliseconds(0);return r.getTime()/1e3}if(t.name=="year"){var n=new Date((e+t.seconds-1)*1e3),r=new Date(0);r.setUTCFullYear(n.getUTCFullYear());r.setUTCMonth(0);r.setUTCDate(1);r.setUTCHours(0);r.setUTCMinutes(0);r.setUTCSeconds(0);r.setUTCMilliseconds(0);return r.getTime()/1e3}return Math.ceil(e/t.seconds)*t.seconds}};Rickshaw.namespace("Rickshaw.Fixtures.Number");Rickshaw.Fixtures.Number.formatKMBT=function(e){abs_y=Math.abs(e);return abs_y>=1e12?e/1e12+"T":abs_y>=1e9?e/1e9+"B":abs_y>=1e6?e/1e6+"M":abs_y>=1e3?e/1e3+"K":abs_y<1&&e>0?e.toFixed(2):abs_y==0?"":e};Rickshaw.Fixtures.Number.formatBase1024KMGTP=function(e){abs_y=Math.abs(e);return abs_y>=0x4000000000000?e/0x4000000000000+"P":abs_y>=1099511627776?e/1099511627776+"T":abs_y>=1073741824?e/1073741824+"G":abs_y>=1048576?e/1048576+"M":abs_y>=1024?e/1024+"K":abs_y<1&&e>0?e.toFixed(2):abs_y==0?"":e};Rickshaw.namespace("Rickshaw.Color.Palette");Rickshaw.Color.Palette=function(e){var t=new Rickshaw.Fixtures.Color;e=e||{};this.schemes={};this.scheme=t.schemes[e.scheme]||e.scheme||t.schemes.colorwheel;this.runningIndex=0;this.generatorIndex=0;if(e.interpolatedStopCount){var n=this.scheme.length-1,r,i,s=[];for(r=0;r<n;r++){s.push(this.scheme[r]);var o=d3.interpolateHsl(this.scheme[r],this.scheme[r+1]);for(i=1;i<e.interpolatedStopCount;i++)s.push(o(1/e.interpolatedStopCount*i))}s.push(this.scheme[this.scheme.length-1]);this.scheme=s}this.rotateCount=this.scheme.length;this.color=function(e){return this.scheme[e]||this.scheme[this.runningIndex++]||this.interpolateColor()||"#808080"};this.interpolateColor=function(){if(!Array.isArray(this.scheme))return;var e;if(this.generatorIndex==this.rotateCount*2-1){e=d3.interpolateHsl(this.scheme[this.generatorIndex],this.scheme[0])(.5);this.generatorIndex=0;this.rotateCount*=2}else{e=d3.interpolateHsl(this.scheme[this.generatorIndex],this.scheme[this.generatorIndex+1])(.5);this.generatorIndex++}this.scheme.push(e);return e}};Rickshaw.namespace("Rickshaw.Graph.Ajax");Rickshaw.Graph.Ajax=Rickshaw.Class.create({initialize:function(e){this.dataURL=e.dataURL;this.onData=e.onData||function(e){return e};this.onComplete=e.onComplete||function(){};this.onError=e.onError||function(){};this.args=e;this.request()},request:function(){$.ajax({url:this.dataURL,dataType:"json",success:this.success.bind(this),error:this.error.bind(this)})},error:function(){console.log("error loading dataURL: "+this.dataURL);this.onError(this)},success:function(e,t){e=this.onData(e);this.args.series=this._splice({data:e,series:this.args.series});this.graph=this.graph||new Rickshaw.Graph(this.args);this.graph.render();this.onComplete(this)},_splice:function(e){var t=e.data,n=e.series;if(!e.series)return t;n.forEach(function(e){var n=e.key||e.name;if(!n)throw"series needs a key or a name";t.forEach(function(t){var r=t.key||t.name;if(!r)throw"data needs a key or a name";if(n==r){var i=["color","name","data"];i.forEach(function(n){t[n]&&(e[n]=t[n])})}})});return n}});Rickshaw.namespace("Rickshaw.Graph.Annotate");Rickshaw.Graph.Annotate=function(e){var t=this.graph=e.graph;this.elements={timeline:e.element};var n=this;this.data={};this.elements.timeline.classList.add("rickshaw_annotation_timeline"
);this.add=function(e,t,r){n.data[e]=n.data[e]||{boxes:[]};n.data[e].boxes.push({content:t,end:r})};this.update=function(){Rickshaw.keys(n.data).forEach(function(e){var t=n.data[e],r=n.graph.x(e);if(r<0||r>n.graph.x.range()[1]){if(t.element){t.line.classList.add("offscreen");t.element.style.display="none"}t.boxes.forEach(function(e){e.rangeElement&&e.rangeElement.classList.add("offscreen")});return}if(!t.element){var i=t.element=document.createElement("div");i.classList.add("annotation");this.elements.timeline.appendChild(i);i.addEventListener("click",function(e){i.classList.toggle("active");t.line.classList.toggle("active");t.boxes.forEach(function(e){e.rangeElement&&e.rangeElement.classList.toggle("active")})},!1)}t.element.style.left=r+"px";t.element.style.display="block";t.boxes.forEach(function(e){var i=e.element;if(!i){i=e.element=document.createElement("div");i.classList.add("content");i.innerHTML=e.content;t.element.appendChild(i);t.line=document.createElement("div");t.line.classList.add("annotation_line");n.graph.element.appendChild(t.line);if(e.end){e.rangeElement=document.createElement("div");e.rangeElement.classList.add("annotation_range");n.graph.element.appendChild(e.rangeElement)}}if(e.end){var s=r,o=Math.min(n.graph.x(e.end),n.graph.x.range()[1]);if(s>o){o=r;s=Math.max(n.graph.x(e.end),n.graph.x.range()[0])}var u=o-s;e.rangeElement.style.left=s+"px";e.rangeElement.style.width=u+"px";e.rangeElement.classList.remove("offscreen")}t.line.classList.remove("offscreen");t.line.style.left=r+"px"})},this)};this.graph.onUpdate(function(){n.update()})};Rickshaw.namespace("Rickshaw.Graph.Axis.Time");Rickshaw.Graph.Axis.Time=function(e){var t=this;this.graph=e.graph;this.elements=[];this.ticksTreatment=e.ticksTreatment||"plain";this.fixedTimeUnit=e.timeUnit;var n=new Rickshaw.Fixtures.Time;this.appropriateTimeUnit=function(){var e,t=n.units,r=this.graph.x.domain(),i=r[1]-r[0];t.forEach(function(t){Math.floor(i/t.seconds)>=2&&(e=e||t)});return e||n.units[n.units.length-1]};this.tickOffsets=function(){var e=this.graph.x.domain(),t=this.fixedTimeUnit||this.appropriateTimeUnit(),r=Math.ceil((e[1]-e[0])/t.seconds),i=e[0],s=[];for(var o=0;o<r;o++){var u=n.ceil(i,t);i=u+t.seconds/2;s.push({value:u,unit:t})}return s};this.render=function(){this.elements.forEach(function(e){e.parentNode.removeChild(e)});this.elements=[];var e=this.tickOffsets();e.forEach(function(e){if(t.graph.x(e.value)>t.graph.x.range()[1])return;var n=document.createElement("div");n.style.left=t.graph.x(e.value)+"px";n.classList.add("x_tick");n.classList.add(t.ticksTreatment);var r=document.createElement("div");r.classList.add("title");r.innerHTML=e.unit.formatter(new Date(e.value*1e3));n.appendChild(r);t.graph.element.appendChild(n);t.elements.push(n)})};this.graph.onUpdate(function(){t.render()})};Rickshaw.namespace("Rickshaw.Graph.Axis.X");Rickshaw.Graph.Axis.X=function(e){var t=this,n=.1;this.initialize=function(e){this.graph=e.graph;this.orientation=e.orientation||"top";var n=e.pixelsPerTick||75;this.ticks=e.ticks||Math.floor(this.graph.width/n);this.tickSize=e.tickSize||4;this.ticksTreatment=e.ticksTreatment||"plain";if(e.element){this.element=e.element;this._discoverSize(e.element,e);this.vis=d3.select(e.element).append("svg:svg").attr("height",this.height).attr("width",this.width).attr("class","rickshaw_graph x_axis_d3");this.element=this.vis[0][0];this.element.style.position="relative";this.setSize({width:e.width,height:e.height})}else this.vis=this.graph.vis;this.graph.onUpdate(function(){t.render()})};this.setSize=function(e){e=e||{};if(!this.element)return;this._discoverSize(this.element.parentNode,e);this.vis.attr("height",this.height).attr("width",this.width*(1+n));var t=Math.floor(this.width*n/2);this.element.style.left=-1*t+"px"};this.render=function(){this.graph.width!==this._renderWidth&&this.setSize({auto:!0});var t=d3.svg.axis().scale(this.graph.x).orient(this.orientation);t.tickFormat(e.tickFormat||function(e){return e});var r=Math.floor(this.width*n/2)||0;if(this.orientation=="top")var i=this.height||this.graph.height,s="translate("+r+","+i+")";else var s="translate("+r+", 0)";this.element&&this.vis.selectAll("*").remove();this.vis.append("svg:g").attr("class",["x_ticks_d3",this.ticksTreatment].join(" ")).attr("transform",s).call(t.ticks(this.ticks).tickSubdivide(0).tickSize(this.tickSize));var o=(this.orientation=="bottom"?1:-1)*this.graph.height;this.graph.vis.append("svg:g").attr("class","x_grid_d3").call(t.ticks(this.ticks).tickSubdivide(0).tickSize(o));this._renderHeight=this.graph.height};this._discoverSize=function(e,t){if(typeof window!="undefined"){var r=window.getComputedStyle(e,null),i=parseInt(r.getPropertyValue("height"));if(!t.auto)var s=parseInt(r.getPropertyValue("width"))}this.width=(t.width||s||this.graph.width)*(1+n);this.height=t.height||i||40};this.initialize(e)};Rickshaw.namespace("Rickshaw.Graph.Axis.Y");Rickshaw.Graph.Axis.Y=function(e){var t=this,n=.1;this.initialize=function(e){this.graph=e.graph;this.orientation=e.orientation||"right";var n=e.pixelsPerTick||75;this.ticks=e.ticks||Math.floor(this.graph.height/n);this.tickSize=e.tickSize||4;this.ticksTreatment=e.ticksTreatment||"plain";if(e.element){this.element=e.element;this.vis=d3.select(e.element).append("svg:svg").attr("class","rickshaw_graph y_axis");this.element=this.vis[0][0];this.element.style.position="relative";this.setSize({width:e.width,height:e.height})}else this.vis=this.graph.vis;this.graph.onUpdate(function(){t.render()})};this.setSize=function(e){e=e||{};if(!this.element)return;if(typeof window!="undefined"){var t=window.getComputedStyle(this.element.parentNode,null),r=parseInt(t.getPropertyValue("width"));if(!e.auto)var i=parseInt(t.getPropertyValue("height"))}this.width=e.width||r||this.graph.width*n;this.height=e.height||i||this.graph.height;this.vis.attr("width",this.width).attr("height",this.height*(1+n));var s=this.height*n;this.element.style.top=-1*s+"px"};this.render=function(){this.graph.height!==this._renderHeight&&this.setSize({auto:!0});var t=d3.svg.axis().scale(this.graph.y).orient(this.orientation);t.tickFormat(e.tickFormat||function(e){return e});if(this.orientation=="left")var r=this.height*n,i="translate("+this.width+", "+r+")";this.element&&this.vis.selectAll("*").remove();this.vis.append("svg:g").attr("class",["y_ticks",this.ticksTreatment].join(" ")).attr("transform",i).call(t.ticks(this.ticks).tickSubdivide(0).tickSize(this.tickSize));var s=(this.orientation=="right"?1:-1)*this.graph.width;this.graph.vis.append("svg:g").attr("class","y_grid").call(t.ticks(this.ticks).tickSubdivide(0).tickSize(s));this._renderHeight=this.graph.height};this.initialize(e)};Rickshaw.namespace("Rickshaw.Graph.Behavior.Series.Highlight");Rickshaw.Graph.Behavior.Series.Highlight=function(e){this.graph=e.graph;this.legend=e.legend;var t=this,n={},r=null;this.addHighlightEvents=function(e){e.element.addEventListener("mouseover",function(i){if(r)return;r=e;t.legend.lines.forEach(function(r,i){if(e===r){if(i>0&&t.graph.renderer.unstack){var s=t.graph.series.length-i-1;r.originalIndex=s;var o=t.graph.series.splice(s,1)[0];t.graph.series.push(o)}return}n[r.series.name]=n[r.series.name]||r.series.color;r.series.color=d3.interpolateRgb(r.series.color,d3.rgb("#d8d8d8"))(.8).toString()});t.graph.update()},!1);e.element.addEventListener("mouseout",function(i){if(!r)return;r=null;t.legend.lines.forEach(function(r){if(e===r&&r.hasOwnProperty("originalIndex")){var i=t.graph.series.pop();t.graph.series.splice(r.originalIndex,0,i);delete r.originalIndex}n[r.series.name]&&(r.series.color=n[r.series.name])});t.graph.update()},!1)};this.legend&&this.legend.lines.forEach(function(e){t.addHighlightEvents(e)})};Rickshaw.namespace("Rickshaw.Graph.Behavior.Series.Order");Rickshaw.Graph.Behavior.Series.Order=function(e){this.graph=e.graph;this.legend=e.legend;var t=this;$(function(){$(t.legend.list).sortable({containment:"parent",tolerance:"pointer",update:function(e,n){var r=[];$(t.legend.list).find("li").each(function(e,t){if(!t.series)return;r.push(t.series)});for(var i=t.graph.series.length-1;i>=0;i--)t.graph.series[i]=r.shift();t.graph.update()}});$(t.legend.list).disableSelection()});this.graph.onUpdate(function(){var e=window.getComputedStyle(t.legend.element).height;t.legend.element.style.height=e})};Rickshaw.namespace("Rickshaw.Graph.Behavior.Series.Toggle");Rickshaw.Graph.Behavior.Series.Toggle=function(e){this.graph=e.graph;this.legend=e.legend;var t=this;this.addAnchor=function(e){var n=document.createElement("a");n.innerHTML="&#10004;";n.classList.add("action");e.element.insertBefore(n,e.element.firstChild);n.onclick=function(t){if(e.series.disabled){e.series.enable();e.element.classList.remove("disabled")}else{e.series.disable();e.element.classList.add("disabled")}};var r=e.element.getElementsByTagName("span")[0];r.onclick=function(n){var r=e.series.disabled;if(!r)for(var i=0;i<t.legend.lines.length;i++){var s=t.legend.lines[i];if(e.series!==s.series&&!s.series.disabled){r=!0;break}}if(r){e.series.enable();e.element.classList.remove("disabled");t.legend.lines.forEach(function(t){if(e.series!==t.series){t.series.disable();t.element.classList.add("disabled")}})}else t.legend.lines.forEach(function(e){e.series.enable();e.element.classList.remove("disabled")})}};if(this.legend){$(this.legend.list).sortable({start:function(e,t){t.item.bind("no.onclick",function(e){e.preventDefault()})},stop:function(e,t){setTimeout(function(){t.item.unbind("no.onclick")},250)}});this.legend.lines.forEach(function(e){t.addAnchor(e)})}this._addBehavior=function(){this.graph.series.forEach(function(e){e.disable=function(){if(t.graph.series.length<=1)throw"only one series left";e.disabled=!0;t.graph.update()};e.enable=function(){e.disabled=!1;t.graph.update()}})};this._addBehavior();this.updateBehaviour=function(){this._addBehavior()}};Rickshaw.namespace("Rickshaw.Graph.HoverDetail");Rickshaw.Graph.HoverDetail=Rickshaw.Class.create({initialize:function(e){var t=this.graph=e.graph;this.xFormatter=e.xFormatter||function(e){return(new Date(e*1e3)).toUTCString()};this.yFormatter=e.yFormatter||function(e){return e===null?e:e.toFixed(2)};var n=this.element=document.createElement("div");n.className="detail";this.visible=!0;t.element.appendChild(n);this.lastEvent=null;this._addListeners();this.onShow=e.onShow;this.onHide=e.onHide;this.onRender=e.onRender;this.formatter=e.formatter||this.formatter},formatter:function(e,t,n,r,i,s){return e.name+":&nbsp;"+i},update:function(e){e=e||this.lastEvent;if(!e)return;this.lastEvent=e;if(!e.target.nodeName.match(/^(path|svg|rect)$/))return;var t=this.graph,n=e.offsetX||e.layerX,r=e.offsetY||e.layerY,i=0,s=[],o;this.graph.series.active().forEach(function(e){var u=this.graph.stackedData[i++],a=t.x.invert(n),f=d3.scale.linear().domain([u[0].x,u.slice(-1)[0].x]).range([0,u.length]),l=Math.floor(f(a)),c=Math.min(l||0,u.length-1);for(var h=l;h<u.length-1;){if(!u[h]||!u[h+1])break;if(u[h].x<=a&&u[h+1].x>a){c=h;break}u[h+1].x<=a?h++:h--}var p=u[c],d=Math.sqrt(Math.pow(Math.abs(t.x(p.x)-n),2)+Math.pow(Math.abs(t.y(p.y+p.y0)-r),2)),v=e.xFormatter||this.xFormatter,m=e.yFormatter||this.yFormatter,g={formattedXValue:v(p.x),formattedYValue:m(p.y),series:e,value:p,distance:d,order:i,name:e.name};if(!o||d<o.distance)o=g;s.push(g)},this);o.active=!0;var u=o.value.x,a=o.formattedXValue;this.element.innerHTML="";this.element.style.left=t.x(u)+"px";this.visible&&this.render({points:s,detail:s,mouseX:n,mouseY:r,formattedXValue:a,domainX:u})},hide:function(){this.visible=!1;this.element.classList.add("inactive");typeof this.onHide=="function"&&this.onHide()},show:function(){this.visible=!0;this.element.classList.remove("inactive");typeof this.onShow=="function"&&this.onShow()},render:function(e){var t=this.graph,n=e.points,r=n.filter(function(e){return e.active}).shift();if(r.value.y===null)return;var i=this.xFormatter(r.value.x),s=this.yFormatter(r.value.y);this.element.innerHTML="";this.element.style.left=t.x(r.value.x)+"px";var o=document.createElement("div");o.className="x_label";o.innerHTML=i;this.element.appendChild(o);var u=document.createElement("div");u.className="item";u.innerHTML=this.formatter(r.series,r.value.x,r.value.y,i,s,r);u.style.top=this.graph.y(r.value.y0+r.value.y)+"px";this.element.appendChild(u);var a=document.createElement("div");a.className="dot";a.style.top=u.style.top;a.style.borderColor=r.series.color;this.element.appendChild(a);if(r.active){u.className="item active";a.className="dot active"}this.show();typeof this.onRender=="function"&&this.onRender(e)},_addListeners:function(){this.graph.element.addEventListener("mousemove",function(e){this.visible=!0;this.update(e)}.bind(this),!1);this.graph.onUpdate(function(){this.update()}.bind(this));this.graph.element.addEventListener("mouseout",function(e){e.relatedTarget&&!(e.relatedTarget.compareDocumentPosition(this.graph.element)&Node.DOCUMENT_POSITION_CONTAINS)&&this.hide()}.bind(this),!1)}});Rickshaw.namespace("Rickshaw.Graph.JSONP");Rickshaw.Graph.JSONP=Rickshaw.Class.create(Rickshaw.Graph.Ajax,{request:function(){$.ajax({url:this.dataURL,dataType:"jsonp",success:this.success.bind(this),error:this.error.bind(this)})}});Rickshaw.namespace("Rickshaw.Graph.Legend");Rickshaw.Graph.Legend=function(e){var t=this.element=e.element,n=this.graph=e.graph,r=this;t.classList.add("rickshaw_legend");var i=this.list=document.createElement("ul");t.appendChild(i);var s=n.series.map(function(e){return e});e.naturalOrder||(s=s.reverse());this.lines=[];this.addLine=function(e){var t=document.createElement("li");t.className="line";var n=document.createElement("div");n.className="swatch";n.style.backgroundColor=e.color;t.appendChild(n);var s=document.createElement("span");s.className="label";s.innerHTML=e.name;t.appendChild(s);i.appendChild(t);t.series=e;e.noLegend&&(t.style.display="none");var o={element:t,series:e};if(r.shelving){r.shelving.addAnchor(o);r.shelving.updateBehaviour()}r.highlighter&&r.highlighter.addHighlightEvents(o);r.lines.push(o)};s.forEach(function(e){r.addLine(e)});n.onUpdate(function(){})};Rickshaw.namespace("Rickshaw.Graph.RangeSlider");Rickshaw.Graph.RangeSlider=function(e){var t=this.element=e.element,n=this.graph=e.graph;$(function(){$(t).slider({range:!0,min:n.dataDomain()[0],max:n.dataDomain()[1],values:[n.dataDomain()[0],n.dataDomain()[1]],slide:function(e,t){n.window.xMin=t.values[0];n.window.xMax=t.values[1];n.update();n.dataDomain()[0]==t.values[0]&&(n.window.xMin=undefined);n.dataDomain()[1]==t.values[1]&&(n.window.xMax=undefined)}})});t[0].style.width=n.width+"px";n.onUpdate(function(){var e=$(t).slider("option","values");$(t).slider("option","min",n.dataDomain()[0]);$(t).slider("option","max",n.dataDomain()[1]);n.window.xMin==undefined&&(e[0]=n.dataDomain()[0]);n.window.xMax==undefined&&(e[1]=n.dataDomain()[1]);$(t).slider("option","values",e)})};Rickshaw.namespace("Rickshaw.Graph.Renderer");Rickshaw.Graph.Renderer=Rickshaw.Class.create({initialize:function(e){this.graph=e.graph;this.tension=e.tension||this.tension;this.graph.unstacker=this.graph.unstacker||new Rickshaw.Graph.Unstacker({graph:this.graph});this.configure(e)},seriesPathFactory:function(){},seriesStrokeFactory:function(){},defaults:function(){return{tension:.8,strokeWidth:2,unstack:!0,padding:{top:.01,right:0,bottom:.01,left:0},stroke:!1,fill:!1}},domain:function(){var e={xMin:[],xMax:[],y:[]},t=this.graph.stackedData||this.graph.stackData(),n=t[0][0],r=n.x,i=n.x,s=n.y+n.y0,o=n.y+n.y0;t.forEach(function(e){e.forEach(function(e){var t=e.y+e.y0;t<s&&(s=t);t>o&&(o=t)});e[0].x<r&&(r=e[0].x);e[e.length-1].x>i&&(i=e[e.length-1].x)});r-=(i-r)*this.padding.left;i+=(i-r)*this.padding.right;s=this.graph.min==="auto"?s:this.graph.min||0;o=this.graph.max||o;if(this.graph.min==="auto"||s<0)s-=(o-s)*this.padding.bottom;this.graph.max===undefined&&(o+=(o-s)*this.padding.top);return{x:[r,i],y:[s,o]}},render:function(){var e=this.graph;e.vis.selectAll("*").remove();var t=e.vis.selectAll("path").data(this.graph.stackedData).enter().append("svg:path").attr("d",this.seriesPathFactory()),n=0;e.series.forEach(function(e){if(e.disabled)return;e.path=t[0][n++];this._styleSeries(e)},this)},_styleSeries:function(e){var t=this.fill?e.color:"none",n=this.stroke?e.color:"none";e.path.setAttribute("fill",t);e.path.setAttribute("stroke",n);e.path.setAttribute("stroke-width",this.strokeWidth);e.path.setAttribute("class",e.className)},configure:function(e){e=e||{};Rickshaw.keys(this.defaults()).forEach(function(t){if(!e.hasOwnProperty(t)){this[t]=this[t]||this.graph[t]||this.defaults()[t];return}typeof this.defaults()[t]=="object"?Rickshaw.keys(this.defaults()[t]).forEach(function(n){this[t][n]=e[t][n]!==undefined?e[t][n]:this[t][n]!==undefined?this[t][n]:this.defaults()[t][n]},this):this[t]=e[t]!==undefined?e[t]:this[t]!==undefined?this[t]:this.graph[t]!==undefined?this.graph[t]:this.defaults()[t]},this)},setStrokeWidth:function(e){e!==undefined&&(this.strokeWidth=e)},setTension:function(e){e!==undefined&&(this.tension=e)}});Rickshaw.namespace("Rickshaw.Graph.Renderer.Line");Rickshaw.Graph.Renderer.Line=Rickshaw.Class.create(Rickshaw.Graph.Renderer,{name:"line",defaults:function(e){return Rickshaw.extend(e(),{unstack:!0,fill:!1,stroke:!0})},seriesPathFactory:function(){var e=this.graph,t=d3.svg.line().x(function(t){return e.x(t.x)}).y(function(t){return e.y(t.y)}).interpolate(this.graph.interpolation).tension(this.tension);t.defined&&t.defined(function(e){return e.y!==null});return t}});Rickshaw.namespace("Rickshaw.Graph.Renderer.Stack");Rickshaw.Graph.Renderer.Stack=Rickshaw.Class.create(Rickshaw.Graph.Renderer,{name:"stack",defaults:function(e){return Rickshaw.extend(e(),{fill:!0,stroke:!1,unstack:!1})},seriesPathFactory:function(){var e=this.graph,t=d3.svg.area().x(function(t){return e.x(t.x)}).y0(function(t){return e.y(t.y0)}).y1(function(t){return e.y(t.y+t.y0)}).interpolate(this.graph.interpolation).tension(this.tension);t.defined&&t.defined(function(e){return e.y!==null});return t}});Rickshaw.namespace("Rickshaw.Graph.Renderer.Bar");Rickshaw.Graph.Renderer.Bar=Rickshaw.Class.create(Rickshaw.Graph.Renderer,{name:"bar",defaults:function(e){var t=Rickshaw.extend(e(),{gapSize:.05,unstack:!1});delete t.tension;return t},initialize:function(e,t){t=t||{};this.gapSize=t.gapSize||this.gapSize;e(t)},domain:function(e){var t=e(),n=this._frequentInterval();t.x[1]+=parseInt(n.magnitude);return t},barWidth:function(){var e=this.graph.stackedData||this.graph.stackData(),t=e.slice(-1).shift(),n=this._frequentInterval(),r=this.graph.x(t[0].x+n.magnitude*(1-this.gapSize));return r},render:function(){var e=this.graph;e.vis.selectAll("*").remove();var t=this.barWidth(),n=0,r=e.series.filter(function(e){return!e.disabled}).length,i=this.unstack?t/r:t,s=function(t){var n=[1,0,0,t.y<0?-1:1,0,t.y<0?e.y.magnitude(Math.abs(t.y))*2:0];return"matrix("+n.join(",")+")"};e.series.forEach(function(t){if(t.disabled)return;var r=e.vis.selectAll("path").data(t.stack.filter(function(e){return e.y!==null})).enter().append("svg:rect").attr("x",function(t){return e.x(t.x)+n}).attr("y",function(t){return e.y(t.y0+Math.abs(t.y))*(t.y<0?-1:1)}).attr("width",i).attr("height",function(t){return e.y.magnitude(Math.abs(t.y))}).attr("transform",s);Array.prototype.forEach.call(r[0],function(e){e.setAttribute("fill",t.color)});this.unstack&&(n+=i)},this)},_frequentInterval:function(){var e=this.graph.stackedData||this.graph.stackData(),t=e.slice(-1).shift(),n={};for(var r=0;r<t.length-1;r++){var i=t[r+1].x-t[r].x;n[i]=n[i]||0;n[i]++}var s={count:0};Rickshaw.keys(n).forEach(function(e){s.count<n[e]&&(s={count:n[e],magnitude:e})});this._frequentInterval=function(){return s};return s}});Rickshaw.namespace("Rickshaw.Graph.Renderer.Area");Rickshaw.Graph.Renderer.Area=Rickshaw.Class.create(Rickshaw.Graph.Renderer,{name:"area",defaults:function(e){return Rickshaw.extend(e(),{unstack:!1,fill:!1,stroke:!1})},seriesPathFactory:function(){var e=this.graph,t=d3.svg.area().x(function(t){return e.x(t.x)}).y0(function(t){return e.y(t.y0)}).y1(function(t){return e.y(t.y+t.y0)}).interpolate(e.interpolation).tension(this.tension);t.defined&&t.defined(function(e){return e.y!==null});return t},seriesStrokeFactory:function(){var e=this.graph,t=d3.svg.line().x(function(t){return e.x(t.x)}).y(function(t){return e.y(t.y+t.y0)}).interpolate(e.interpolation).tension(this.tension);t.defined&&t.defined(function(e){return e.y!==null});return t},render:function(){var e=this.graph;e.vis.selectAll("*").remove();var t=this.unstack?"append":"insert",n=e.vis.selectAll("path").data(this.graph.stackedData).enter()[t]("svg:g","g");n.append("svg:path").attr("d",this.seriesPathFactory()).attr("class","area");this.stroke&&n.append("svg:path").attr("d",this.seriesStrokeFactory()).attr("class","line");var r=0;e.series.forEach(function(e){if(e.disabled)return;e.path=n[0][r++];this._styleSeries(e)},this)},_styleSeries:function(e){if(!e.path)return;d3.select(e.path).select(".area").attr("fill",e.color);this.stroke&&d3.select(e.path).select(".line").attr("fill","none").attr("stroke",e.stroke||d3.interpolateRgb(e.color,"black")(.125)).attr("stroke-width",this.strokeWidth);e.className&&e.path.setAttribute("class",e.className)}});Rickshaw.namespace("Rickshaw.Graph.Renderer.ScatterPlot");Rickshaw.Graph.Renderer.ScatterPlot=Rickshaw.Class.create(Rickshaw.Graph.Renderer,{name:"scatterplot",defaults:function(e){return Rickshaw.extend(e(),{unstack:!0,fill:!0,stroke:!1,padding:{top:.01,right:.01,bottom:.01,left:.01},dotSize:4})},initialize:function(e,t){e(t)},render:function(){var e=this.graph;e.vis.selectAll("*").remove();e.series.forEach(function(t){if(t.disabled)return;var n=e.vis.selectAll("path").data(t.stack.filter(function(e){return e.y!==null})).enter().append("svg:circle").attr("cx",function(t){return e.x(t.x)}).attr("cy",function(t){return e.y(t.y)}).attr("r",function(t){return"r"in t?t.r:e.renderer.dotSize});Array.prototype.forEach.call(n[0],function(e){e.setAttribute("fill",t.color)})},this)}});Rickshaw.namespace("Rickshaw.Graph.Smoother");Rickshaw.Graph.Smoother=function(e){this.graph=e.graph;this.element=e.element;var t=this;this.aggregationScale=1;this.element&&$(function(){$(t.element).slider({min:1,max:100,slide:function(e,n){t.setScale(n.value);t.graph.update()}})});t.graph.stackData.hooks.data.push({name:"smoother",orderPosition:50,f:function(e){if(t.aggregationScale==1)return e;var n=[];e.forEach(function(e){var r=[];while(e.length){var i=0,s=0,o=e.splice(0,t.aggregationScale);o.forEach(function(e){i+=e.x/o.length;s+=e.y/o.length});r.push({x:i,y:s})}n.push(r)});return n}});this.setScale=function(e){if(e<1)throw"scale out of range: "+e;this.aggregationScale=e;this.graph.update()}};Rickshaw.namespace("Rickshaw.Graph.Unstacker");Rickshaw.Graph.Unstacker=function(e){this.graph=e.graph;var t=this;this.graph.stackData.hooks.after.push({name:"unstacker",f:function(e){if(!t.graph.renderer.unstack)return e;e.forEach(function(e){e.forEach(function(e){e.y0=0})});return e}})};Rickshaw.namespace("Rickshaw.Series");Rickshaw.Series=Rickshaw.Class.create(Array,{initialize:function(e,t,n){n=n||{};this.palette=new Rickshaw.Color.Palette(t);this.timeBase=typeof n.timeBase=="undefined"?Math.floor((new Date).getTime()/1e3):n.timeBase;var r=typeof n.timeInterval=="undefined"?1e3:n.timeInterval;this.setTimeInterval(r);e&&typeof e=="object"&&e instanceof Array&&e.forEach(function(e){this.addItem(e)},this)},addItem:function(e){if(typeof e.name=="undefined")throw"addItem() needs a name";e.color=e.color||this.palette.color(e.name);e.data=e.data||[];e.data.length==0&&this.length&&this.getIndex()>0?this[0].data.forEach(function(t){e.data.push({x:t.x,y:0})}):e.data.length==0&&e.data.push({x:this.timeBase-(this.timeInterval||0),y:0});this.push(e);this.legend&&this.legend.addLine(this.itemByName(e.name))},addData:function(e){var t=this.getIndex();Rickshaw.keys(e).forEach(function(e){this.itemByName(e)||this.addItem({name:e})},this);this.forEach(function(n){n.data.push({x:(t*this.timeInterval||1)+this.timeBase,y:e[n.name]||0})},this)},getIndex:function(){return this[0]&&this[0].data&&this[0].data.length?this[0].data.length:0},itemByName:function(e){for(var t=0;t<this.length;t++)if(this[t].name==e)return this[t]},setTimeInterval:function(e){this.timeInterval=e/1e3},setTimeBase:function(e){this.timeBase=e},dump:function(){var e={timeBase:this.timeBase,timeInterval:this.timeInterval,items:[]};this.forEach(function(t){var n={color:t.color,name:t.name,data:[]};t.data.forEach(function(e){n.data.push({x:e.x,y:e.y})});e.items.push(n)});return e},load:function(e){e.timeInterval&&(this.timeInterval=e.timeInterval);e.timeBase&&(this.timeBase=e.timeBase);e.items&&e.items.forEach(function(e){this.push(e);this.legend&&this.legend.addLine(this.itemByName(e.name))},this)}});Rickshaw.Series.zeroFill=function(e){Rickshaw.Series.fill(e,0)};Rickshaw.Series.fill=function(e,t){var n,r=0,i=e.map(function(e){return e.data});while(r<Math.max.apply(null,i.map(function(e){return e.length}))){n=Math.min.apply(null,i.filter(function(e){return e[r]}).map(function(e){return e[r].x}));i.forEach(function(e){(!e[r]||e[r].x!=n)&&e.splice(r,0,{x:n,y:t})});r++}};Rickshaw.namespace("Rickshaw.Series.FixedDuration");Rickshaw.Series.FixedDuration=Rickshaw.Class.create(Rickshaw.Series,{initialize:function(e,t,n){var n=n||{};if(typeof n.timeInterval=="undefined")throw new Error("FixedDuration series requires timeInterval");if(typeof n.maxDataPoints=="undefined")throw new Error("FixedDuration series requires maxDataPoints");this.palette=new Rickshaw.Color.Palette(t);this.timeBase=typeof n.timeBase=="undefined"?Math.floor((new Date).getTime()/1e3):n.timeBase;this.setTimeInterval(n.timeInterval);if(this[0]&&this[0].data&&this[0].data.length){this.currentSize=this[0].data.length;this.currentIndex=this[0].data.length}else{this.currentSize=0;this.currentIndex=0}this.maxDataPoints=n.maxDataPoints;if(e&&typeof e=="object"&&e instanceof Array){e.forEach(function(e){this.addItem(e)},this);this.currentSize+=1;this.currentIndex+=1}this.timeBase-=(this.maxDataPoints-this.currentSize)*this.timeInterval;if(typeof this.maxDataPoints!="undefined"&&this.currentSize<this.maxDataPoints)for(var r=this.maxDataPoints-this.currentSize-1;r>0;r--){this.currentSize+=1;this.currentIndex+=1;this.forEach(function(e){e.data.unshift({x:((r-1)*this.timeInterval||1)+this.timeBase,y:0,i:r})},this)}},addData:function(e,t){e(t);this.currentSize+=1;this.currentIndex+=1;if(this.maxDataPoints!==undefined)while(this.currentSize>this.maxDataPoints)this.dropData()},dropData:function(){this.forEach(function(e){e.data.splice(0,1)});this.currentSize-=1},getIndex:function(){return this.currentIndex}});(function(e){"use strict";var t=!1;e(document).on("click","a[data-reveal-id]",function(t){t.preventDefault();var n=e(this).attr("data-reveal-id");e("#"+n).reveal(e(this).data())});e.fn.reveal=function(n){var r=e(document),i={animation:"fadeAndPop",animationSpeed:300,closeOnBackgroundClick:!0,dismissModalClass:"close-reveal-modal",open:e.noop,opened:e.noop,close:e.noop,closed:e.noop};n=e.extend({},i,n);return this.not(".reveal-modal.open").each(function(){function c(){u=!1}function h(){u=!0}function p(){var n=e(".reveal-modal.open");if(n.length===1){t=!0;n.trigger("reveal:close")}}function d(){if(!u){h();p();i.addClass("open");if(n.animation==="fadeAndPop"){f.open.top=r.scrollTop()-o;f.open.opacity=0;i.css(f.open);a.fadeIn(n.animationSpeed/2);i.delay(n.animationSpeed/2).animate({top:r.scrollTop()+s+"px",opacity:1},n.animationSpeed,function(){i.trigger("reveal:opened")})}if(n.animation==="fade"){f.open.top=r.scrollTop()+s;f.open.opacity=0;i.css(f.open);a.fadeIn(n.animationSpeed/2);i.delay(n.animationSpeed/2).animate({opacity:1},n.animationSpeed,function(){i.trigger("reveal:opened")})}if(n.animation==="none"){f.open.top=r.scrollTop()+s;f.open.opacity=1;i.css(f.open);a.css({display:"block"});i.trigger("reveal:opened")}}}function v(){var e=i.find(".flex-video"),t=e.find("iframe");if(t.length>0){t.attr("src",t.data("src"));e.fadeIn(100)}}function m(){if(!u){h();i.removeClass("open");if(n.animation==="fadeAndPop"){i.animate({top:r.scrollTop()-o+"px",opacity:0},n.animationSpeed/2,function(){i.css(f.close)});t?i.trigger("reveal:closed"):a.delay(n.animationSpeed).fadeOut(n.animationSpeed,function(){i.trigger("reveal:closed")})}if(n.animation==="fade"){i.animate({opacity:0},n.animationSpeed,function(){i.css(f.close)});t?i.trigger("reveal:closed"):a.delay(n.animationSpeed).fadeOut(n.animationSpeed,function(){i.trigger("reveal:closed")})}if(n.animation==="none"){i.css(f.close);t||a.css({display:"none"});i.trigger("reveal:closed")}t=!1}}function g(){i.unbind(".reveal");a.unbind(".reveal");l.unbind(".reveal");e("body").unbind(".reveal")}function y(){var e=i.find(".flex-video"),t=e.find("iframe");if(t.length>0){t.data("src",t.attr("src"));t.attr("src","");e.fadeOut(100)}}var i=e(this),s=parseInt(i.css("top"),10),o=i.height()+s,u=!1,a=e(".reveal-modal-bg"),f={open:{top:0,opacity:0,visibility:"visible",display:"block"},close:{top:s,opacity:1,visibility:"hidden",display:"none"}},l;if(a.length===0){a=e("<div />",{"class":"reveal-modal-bg"}).insertAfter(i);a.fadeTo("fast",.8)}i.bind("reveal:open.reveal",d);i.bind("reveal:open.reveal",v);i.bind("reveal:close.reveal",m);i.bind("reveal:closed.reveal",y);i.bind("reveal:opened.reveal reveal:closed.reveal",c);i.bind("reveal:closed.reveal",g);i.bind("reveal:open.reveal",n.open);i.bind("reveal:opened.reveal",n.opened);i.bind("reveal:close.reveal",n.close);i.bind("reveal:closed.reveal",n.closed);i.trigger("reveal:open");l=e("."+n.dismissModalClass).bind("click.reveal",function(){i.trigger("reveal:close")});if(n.closeOnBackgroundClick){a.css({cursor:"pointer"});a.bind("click.reveal",function(){i.trigger("reveal:close")})}e("body").bind("keyup.reveal",function(e){e.which===27&&i.trigger("reveal:close")})})}})(jQuery);window.SE.Artist.drawMoneyGraph=function(){"use strict";var e=window.Rickshaw;$("#chart").empty();$("#legend").empty();var t=new e.Graph.Ajax({element:document.getElementById("chart"),width:620,height:300,renderer:"line",dataURL:"/artist/history/?artist_id="+window.SE.Artist.mbid+"&days=7&field=money",series:[{color:"#dc1303",name:"price"},{color:"#0187c5",name:"dividends"}],onComplete:function(t){var n=t.graph,r=new e.Graph.HoverDetail({graph:n,formatter:function(e,t,n){return e.name==="price"?"Market price: $"+n:"Dividends: $"+n}}),i=new e.Graph.Axis.Y({graph:n,tickFormat:e.Fixtures.Number.formatKMBT}),s=new e.Fixtures.Time,o=s.unit("day"),u=new e.Graph.Axis.Time({graph:n,timeUnit:o}),a=new e.Graph.Legend({graph:n,element:document.querySelector("#legend")}),f=new e.Graph.Behavior.Series.Toggle({graph:n,legend:a}),l=new e.Graph.Behavior.Series.Highlight({graph:n,legend:a});n.update();$(".rickshaw_legend span.label").each(function(){$(this).text()==="dividends"?$(this).html("Dividends <strong>($)</strong>"):$(this).text()==="price"&&$(this).html("Market price <strong>($)</strong>")})}})};window.SE.Artist.drawPointsGraph=function(){"use strict";var e=window.Rickshaw;$("#chart").empty();$("#legend").empty();var t=new e.Graph.Ajax({element:document.getElementById("chart"),width:640,height:300,renderer:"line",dataURL:"/artist/history/?artist_id="+window.SE.Artist.mbid+"&days=7&field=points",series:[{color:"#dc1303",name:"points"}],onComplete:function(t){var n=t.graph,r=new e.Graph.HoverDetail({graph:n,formatter:function(e,t,n){return"Points: "+n}}),i=new e.Graph.Axis.Y({graph:n,tickFormat:e.Fixtures.Number.formatKMBT}),s=new e.Fixtures.Time,o=s.unit("day"),u=new e.Graph.Axis.Time({graph:n,timeUnit:o}),a=new e.Graph.Legend({graph:n,element:document.querySelector("#legend")}),f=new e.Graph.Behavior.Series.Toggle({graph:n,legend:a}),l=new e.Graph.Behavior.Series.Highlight({graph:n,legend:a});n.update();$(".rickshaw_legend span.label").each(function(){$(this).html("Points")})}})};window.SE.Artist.guaranteeCount=0;window.SE.Artist.current_price=null;window.SE.Artist.current_guarantee={};window.SE.Artist.current_seconds_left=15;window.SE.Artist.getArtistPriceGuarantee=function(e){var t="/price/guarantee/?artist_id="+e;if(window.SE.Artist.guaranteeCount>=20){$("#buy-sell-modal").trigger("reveal:close");location.reload();return}jQuery.ajax({url:t,type:"GET",dataType:"json",complete:function(e,t){},success:function(e,t,n){var r=Math.round(+(new Date)/1e3);window.SE.Artist.current_guarantee=e;window.SE.Artist.current_seconds_left=e.time-r;$("#buy-sell-modal .price-text").text(e.price);$("#buy-sell-modal .artist-text").text(e.artist.name);window.SE.startCountdown();window.SE.Artist.guaranteeCount=window.SE.Artist.guaranteeCount+1},error:function(e,t,n){$("#buy-sell-modal").trigger("reveal:close");location.reload();window.console.log("ERROR: Guarantee fetch failed..."
)}})};window.SE.Artist.makeTransaction=function(e){var t=e==="buy"?"/buy/":"/sell/";jQuery.ajax({url:t,type:"POST",dataType:"json",data:{artist_id:window.SE.Artist.current_guarantee.artist.mbid,price:window.SE.Artist.current_guarantee.price,time:window.SE.Artist.current_guarantee.time,elephant:window.SE.Artist.current_guarantee.elephant},complete:function(e,t){},success:function(e,t,n){$("#buy-sell-modal").trigger("reveal:close");location.reload()},error:function(e,t,n){window.console.log("failed!");$("#buy-sell-modal .row .alert-box").length===0&&$("#buy-sell-modal .row").prepend('<div style="margin-bottom: 40px;" class="alert-box alert">Alert! Your transaction was not completed - please try again.<a href="" class="close">&times;</a></div>')}})};window.SE.startCountdown=function(){if(window.SE.Artist.current_seconds_left<1){window.SE.Artist.getArtistPriceGuarantee(window.SE.Artist.mbid);return}window.SE.Artist.current_seconds_left=window.SE.Artist.current_seconds_left-1;$("#buy-sell-modal .dial").val(window.SE.Artist.current_seconds_left).trigger("change");$("#buy-sell-modal .timer-text").text(window.SE.Artist.current_seconds_left);window.SE.Artist.current_seconds_left<=5?$("#buy-sell-modal .dial").trigger("configure",{fgColor:"#b40200",inputColor:"#b40200"}):$("#buy-sell-modal .dial").trigger("configure",{fgColor:"#0187c5",inputColor:"#0187c5"});window.SE.price_countdown=window.setTimeout(window.SE.startCountdown,1e3)};jQuery(document).ready(function(e){window.SE.Artist.drawMoneyGraph();e("a.chart-switch").on("click",function(){var t=e(this).parent().hasClass("active"),n=e(this).data("chart");if(!t){e(this).parent().addClass("active").siblings().removeClass("active");n==="money"?window.SE.Artist.drawMoneyGraph():n==="points"&&window.SE.Artist.drawPointsGraph()}});e("#buy-sell-modal .success").on("click",function(){window.SE.Artist.makeTransaction(e("#buy-sell-modal .buy-sell").first().text())});e("#buy-button.enabled, #sell-button.enabled").click(function(){var t=e(this).attr("id"),n=t==="buy-button"?"buy":"sell",r=t==="buy-button"?"auto":"#b40200",i=e(this).data("price"),s=e(this).data("artistname");e("#buy-sell-modal .buy-sell").text(n);e("#buy-sell-modal .label").css("background-color",r);e("#buy-sell-modal").reveal({open:function(){e("#buy-sell-modal .dial").knob().trigger("configure",{fgColor:"#0187c5",inputColor:"#0187c5"})},opened:function(){window.console.log(window.SE.Artist.mbid);window.SE.Artist.getArtistPriceGuarantee(window.SE.Artist.mbid)},closed:function(){window.clearTimeout(window.SE.price_countdown);e("#buy-sell-modal .dial").val(window.SE.Artist.current_seconds_left).trigger("change");window.SE.Artist.guaranteeCount=0}})})});
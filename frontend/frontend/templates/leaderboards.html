{% extends "base.html" %}

{% load static %}
{% load extras %}

{% block title %}Leaderboards{% endblock title %}

{% block above_main %}
    <h1 class="main-header">Leaderboards - <span class="leaderboards-time">Last Week</span></h1>
{% endblock above_main %}

{% block main %}
    <ul class="accordion support tag close leaderboards">
        {% for league in leagues %}
            {% if forloop.first %}
                <li class="active">
            {% else %}
                <li>
            {% endif %}
                    <div class="title">
                        <h5><i class="{{ league.icon|icon_split:'code' }}" style="color: {{ league.icon|icon_split:'colour' }};"></i> {{ league.name }}</h5>
                    </div>
                    <div class="content">
                        <p class="description">{{ league.description }}</p>
                        <table data-leaguename="{{ league.name }}" data-leagueuid="{{ league.uid }}" class="leaderboard leaderboard-{{ forloop.counter }}">
                            <thead>
                                <tr>
                                    <th>Rank</th>
                                    <th>User</th>
                                    <th>Score</th>
                                </tr>
                            </thead>
                        </table>
                    </div>
                </li>
        {% endfor %}
    </ul>
{% endblock main %}

{% block sidebar %}
  {% if user.is_authenticated %}
  <div class="leaderboards-sidebar-inner">
      <h2 class="sidebar-red">Your current position</h2>
      <p class="lead">You are currently ranked <strong><span class="context-user-position"></span></strong> in <strong><span class="context-user-league"></span></strong>, with a total of <strong><span class="context-user-points"></span></strong> points.</p>
      {% if next_user %}
          <p>Earn <strong><span class="context-next_user-points">{{next_user.points}}</span></strong> more points to overtake your closest rival, <a href="#"><strong><span class="context-next_user-name">{{next_user.name}}</span></strong></a>!</p>
      {% endif %}
  </div>
  {% endif %}

  <div class="leaderboards-sidebar-inner">
    <h2 class="sidebar-red">Change timespan</h2>
    <ul>
      <li><a class="time-adjust" data-timeadjust="3" href="#">Last Day</a></li>
      <li><a class="time-adjust selected" data-timeadjust="2" href="#">Last Week</a></li>
      <li><a class="time-adjust" data-timeadjust="1" href="#">Last Month</a></li>
      <li><a class="time-adjust" data-timeadjust="0" href="#">All Time</a></li>
    </ul>
  </div>
{% endblock sidebar %}

{% block body_additional_js %}
  <script type="text/javascript" src="{% static "js/foundation/jquery.foundation.accordion.custom.js" %}"></script>
  <script type="text/javascript" src="{% static "js/libs/jquery.dataTables.js" %}"></script>
  <script type="text/javascript" src="{% static "js/libs/dataTables.scroller.min.js" %}"></script>
    <script type="text/javascript">
      window.SE.User = {
        {% if user.is_authenticated %}
        'username': '{{ user.username }}'
        {% else %}
        'username': ''
        {% endif %}
      }
    </script>
  <script type="text/javascript" src="{% static "js/leaderboards.js" %}"></script>
{% endblock body_additional_js %}
